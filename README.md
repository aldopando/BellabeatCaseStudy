# Bellabeat Case Study


## Summary


Bellabeat is a wellness company founded by Urška Sršen and Sandro Mur in 2014. This company manufactures wellness tracking devices designed to empower women to track and improve their health. Bellabeat stands out by focusing specifically on women's wellness, offering products and features tailored to their unique needs and life stages. 

Unlike many general fitness trackers, Bellabeat devices track menstrual cycles, fertility, and menopause symptoms, while also monitoring sleep, activity, and heart rate.

Focusing on creating innovative health and wellness products for women, their mission is to empower women to take control of their health by providing them with technology-driven solutions that blend design and function. 


**About the company products**.

- **Bellabeat app**: The Bellabeat app provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of smart wellness products.
- **IVY+**: A new generation of wellness and health trackers. Besides tracking steps, sleep, distance, calories, and menstrual cycle logging, IVY+ has advanced sensors to measure  heart rate, heart‑rate variability (HRV), respiratory rate, and cardiac coherence. It also has a sensor that tracks minute-by-minute skin temperature on the wrist to support fertility and menstrual insights.
- **Leaf**: Bellabeat’s classic wellness tracker can be worn as a bracelet, necklace, or clip. The Leaf tracker connects to the Bellabeat app to track activity, sleep, and stress.
- **Time**: This wellness watch combines the timeless look of a classic timepiece with smart technology to track user activity, sleep, and stress. The Time watch connects to the Bellabeat app to provide you with insights into your daily wellness.
- **Spring**: This is a water bottle that tracks daily water intake using smart technology to ensure that you are appropriately hydrated throughout the day. The Spring bottle connects to the Bellabeat app to track your hydration levels.
- **Bellabeat membership**: Bellabeat also offers a subscription-based membership program for users. Membership gives users 24/7 access to fully personalized guidance on nutrition, activity, sleep, health and beauty, and mindfulness based on their lifestyle and goals.


**Stakeholders**.

- Urška Sršen: Bellabeat’s cofounder and Chief Creative Officer.
- Sando Mur: Mathematician and Bellabeat’s cofounder; key member of the Bellabeat executive team.
- Bellabeat marketing analytics team: A team of data analysts responsible for collecting, analyzing, and reporting data that helps guide Bellabeat’s marketing strategy.



## Ask   

**Business Task**.

*Draw meaningful insights and trends into how consumers use non-Bellabeat smart devices and how this information can provide high-level recommendations for Bellabeat marketing strategy*. 


---

**What is the problem you are trying to solve?**

Identify trends and patterns from overall smart devices usage data in order to draw insights and how they may apply in a Bellabeat products. 

 
**How can your insights drive business decisions?**

My insights can influence on how to address the new Bellabeat marketing strategy.



## Prepare

**About the data**.

These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03/12/2016-05/12/2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring.

---
 
**Where is the data stored?**
   
Data is stored in a collection of datasets on Kaggle. This collection contains several tables across different metrics of personal tracker data.

This collection is broken down into two folders, both with same metrics but each folder contains data in different periods of time.


---

**How is the data organized? Is it in long or wide format?** 

The data is organized in two folders, each folder representing a different period of time:
   
- First Folder (11 tables): **Fitabase Data 2016/03/11 - 2016/04/11**
  
	- `dailyActivity_merged.csv`
	  	- The table is in **wide format**.
    	  
	   		- Each has a row has multiple attributes such as `TotalSteps, TotalDistance, TrackerDistance, etc`.
	   	 	- Variables are spread across the columns.
	   	  	- Columns represent different metrics like steps, distance, calories, etc.
	   	  	- Each variable has its own column.

	- `heartrate_seconds_merged.csv`  
		- The table is in **long format**.

			- Each row is a single observation of the variable `heart rate value`   of each user `id` at a specific time `Time`.	    
			- The subject user `id` is repeated across multiple rows to represent the value `heart rate`  at different points of time `Time`.
				
	- `hourlyCalories_merged.csv`
		- The table is in **long format**.

			- Each row is a single observation of the variable `number of calories burnt`   by a specific user `id` at a specific time `ActivityHour`.	    
			- The subject user `id` is repeated across multiple rows to represent a value of `Calories`  at different hours `ActivityHour`.
		
	- `hourlyIntensities_merged.csv`
		- The table is in **long format**.
   
			- It has more than column apparently representing more than one variable. In reality, the second column represents an aggregated function that calculates the **average** of intensity level exhibited during a specific hour by the user. In other words, the column `AverageIntensity` is the statistical summary of the variable `TotalIntensity`.  Therefore, this dataset only contains one variable where each row represents one observation of this variable at a specific time.

	- `hourlySteps_merged.csv` - The table is in **long format**.
  
	- `minuteCaloriesNarrow_merged.csv` - The table is in **long format**.
     
	- `minuteIntensitiesNarrow_merged.csv` - The table is in **long format**.
     			
	- `minuteMETsNarrow_merged.csv` - The table is in **long format**.
			
	- `minuteSleep_merged.csv`
			- The table is in **wide format**.  Each row represents a unique combination of identifiers (user **id**, **date** and **logId**).
			
	- `minuteStepsNarrow_merged.csv` - The table is in **long format**
		
	- `weightLogInfo_merged.csv`
			- The table is in **wide format**. Each data subject `id` has a row of a combination of multiple attributes such as `WeightKg, WeightPounds, Fat, BMI, IsManualReport, LogId`.


---


- Second Folder  (18 tables): **Fitabase Data 2016/04/11 - 2016/05/11** 
	- `dailyActivity_merged.csv*` - The table is in **wide format**.
			
	- `dailyCalories_merged.csv` - The table is in **long format**.
		
	- `dailyIntensities_merged.csv`
		- The table is in **wide format**. In this table there is a combination of multiple columns representing attributes for each row. Each column has its own variable.  A single row has atributes such as `SedentaryMinutes, LightlyActiveMinutes, VeryActiveMinutes, ModeratelyActiveDistance, etc.`
		
	- `dailySteps_merged.csv` - The table is in **long format**.
			
	- `heartrate_seconds_merged.csv` - The table is in **long format**.
			
	- `hourlyCalories_merged.csv` - The table is in **long format**.
			
	- `hourlyIntensities_merged.csv` - The table is in **long format**.
			
	- `hourlySteps_merged.csv` - The table is in **long format**.
			
	- `minuteCaloriesNarrow_merged.csv` - The table is in **long format**.
			
	- `minuteCaloriesWide_merged.csv`
		- The table is in **wide format**. *It has multiple columns that contain the same type of data for different time points.*  For example, columns for `"Calories00", "Calories01", "Calories02"... "Calories59"`  
		E.g.
			***Calories05 = calories burned in fifth minute of the hour.***
			
	- `minuteIntensitiesNarrow_merged.csv`
		- The dataset is in **long format**. It is same data as `minuteCaloriesWide_merged.csv` but in long format. *The time points (minutes) are spread out through the rows*.
			
	- `minuteIntensitiesWide_merged.csv` - The table is in **wide format**.
			
	- `minuteMETsNarrow_merged.csv` - The table is in **long format**.
			
	- `minuteSleep_merged.csv` - The table is in **wide format**.
			
	- `minuteStepsNarrow_merged.csv` - The table is in **long format**.
			
	- `minuteStepsWide_merged.csv` - The table is in **wide format**.
			
	- `sleepDay_merged.csv`
		- The table is in **wide format**. The number of rows in this dataset can initially suggest a "long" format, especially when it can be observed many repeated IDs with different timestamps. But **the format (wide vs. long) is not defined by the number of rows**. it’s defined by **how the variables are organized**
Each row of this dataset is a summary of many variables (`TotalSleepRecords, TotalMinutesAsleep, TotalTimeInBed `) for a specific time `SleepDay`

			
	- `weightLogInfo_merged.csv` - The table is in **wide format**.

---

**Are there issues with bias or credibility in this data? Does your data ROCCC?**

   
**Reliability**.
	   
- ***Uncertainty about bias in the data***: The authors of this dataset doesn't share any information about how participants were chosen for the sample. Therefore, we cannot make sure if the data was collected using random sampling to fairly have a good representation of the population. 
- **Small sample**:  This dataset has a sample size of 30 users. Even though it has been statistically proven that 30 is the smallest sample size where an average result of the sample starts to represent the average result of a population, this dataset is at borderline of this minimum number. A larger sample size would have been better to get more accurate and reliable results from analysis, specially in a very large market. According to [statista](https://www.statista.com/forecasts/1425172/fitness-tracker-users-by-segment-us), in 2024, there were around 62 million fitness tracker users in the United States (35% women). In the near future, the number of fitness tracker users is forecast to steadily increase, jumping from 62 to over 92 million by 2029. 


**Original**.

The dataset is ***third-party data*** , shared by the user *Möbius* on Kaggle. 

Möbius has attached the link of the original source which it comes from an **open data source**, under a **Creative Commons Attribution 4.0 International license**. Meaning anyone can copy, distribute, remix, and build upon the material for any purpose, even commercially, as long as you give credit for the original creators. 

In other words, you can have accessibility to the **original data source** under a permissive license to give credit to the **original authors** who collect and generate this dataset.

  
**Comprehensive**.
  
Critical Information needed to solve the business task:

*The Bellabeat app provides users health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions*. 
    
Data contained in FitBit Fitness Tracker  datasets:
   
*FitBit Fitness Tracker Data contains user's information about their heart rate, sleep monitoring, daily activity by tracking totals for steps, intensity, distance, calories, and logged activities*.

*Therefore, we can make sure that the datasets utilized for this analysis cover most of the important metrics that Bellabeat uses to provide insights about its user's health and wellness. However, we are lacking of specific information about reproductive health data for women. This is an exclusive feature that Bellabeat offers compared to other brands*. 

  
**Completeness**.
    
- **Small sample size**: The sample size fall short, using only *thirty people* as sample size of a huge population that every year is growing more and more. 
- **Short period of time**: The data collection was carried out throughout a two-month period; 2016/03/12 - 2016/05/12. This time period might be a limitation to uncover noticeable changes in user's routine. According to [James Clear](https://jamesclear.com/new-habit#:~:text=On%20average%2C%20it%20takes%20more,to%20form%20a%20new%20habit.), "*On average, it takes more than 2 months before a new behavior becomes automatic — 66 days to be exact. And how long it takes a new habit to form can vary widely depending on the behavior, the person, and the circumstances. In Lally’s study, it took anywhere from 18 days to 254 days for people to form a new habit".*
  
  
  
**Current**
   
Checking the dataset *FitBit Fitness Tracker Data* in its original source, we notice that the last update was May 31, 2016. This data is out of date, which means this data is less relevant to the current time when this analysis is being performed.

    
**Cited**
  
These datasets were created by *Robert, Brinton Furberg, Julia Brinton, Michael Keating and Alexa Ortiz*, published and hosted via Zenodo website, a reliable open repository. 

The data was collected by a distributed survey via Amazon Mechanical Turk between 03/12/2016-05/12/2016. 

  
*Citation*
   
Furberg, R., Brinton, J., Keating, M., & Ortiz, A. (2016). Crowd-sourced Fitbit datasets 03.12.2016-05.12.2016 [Data set]. Zenodo.[https://doi.org/10.5281/zenodo.53894](https://doi.org/10.5281/zenodo.53894)


---

**How are you addressing licensing, privacy, security, and accessibility?**
  
### Authors
 
 Furberg, Robert.
 
 Brinton, Julia.
 
 Keating, Michael.
 
 Ortiz, Alexa.
 
### Citation
   
   Furberg, R., Brinton, J., Keating, M., & Ortiz, A. (2016). Crowd-sourced Fitbit datasets 03.12.2016-05.12.2016 [Data set]. Zenodo.
  
### Rights

**License**

![cc-by-4.0 icon](https://zenodo.org/static/icons/licenses/cc-by-icon.svg)  

[Creative Commons Attribution 4.0 International](https://creativecommons.org/licenses/by/4.0/legalcode)


---

**How does it help you answer your question?**   
 
*FitBit Fitness Tracker Data* contain all critical information (such as heart rate, sleep monitoring, and daily activity) to draw insights, identify patterns, and trends about how people are using wearable devices. 

The collected data is cited and comes from an original and reliable source. The dataset is structured and organized to start cleaning the data and performing analysis.


**Are there any problems with the data?**
 
Problems and limitations with the data:

- **Small sample size:**  This dataset has a sample size of 30 users. The market of people using wearable devices is huge (80 million just in USA) and growing each year. This can be a limitation to get an reliable result of the sample that fairly represents the entire population.  
- **Out of date**: The data was generated since 2016, making it more irrelevant due to  the analysis is being conducted in 2025.
- **Limited period of time:** This period of time might be a limitation to track any change in user's routine, which is essential to identify outliers and have a more complete representation of patterns and tends people have in their wellness and daily activity.
- **Possible biased sample:** The sample may not be a fair representation of the population. We don't have accessibility to details about how participants were eligible to the survey. 
- **Lack of demographic data**: Age and gender are not specified. This is essential information because Bellabeat products are targeted to women and because demographic data can help us to accurately categorize groups during the analysis. 
- **Lack of reproductive health data**: Bellabeat tracks reproductive data such as menstrual cycle, pregnancy and fertility. Nevertheless, this dataset doesn't contain any information about these type of metrics.


Possible incomplete data or inconsistencies: Must be checked during processing.


## Process 


**Changelog**.

Author: Aldair Pichon Aguila.
 
1. I downloaded the datasets from Kaggle in my local machine. 05/20/2025
2. I renamed the two main folders that contain the datasets to ensure better clarity, consistency and organization of the data. I followed guidelines of naming conventions 05/20/2025:

	Fitabase Data 3.12.16-4.11.16  ->   FitabaseData_20160312-20160411

	Fitabase Data 4.12.16-5.12.16  ->  FitabaseData_20160412-20160512

3. I created a new project in BigQuery named `analysisbellabeat246` and a dataset for each folder. 05/20/2025
4. When uploading the table `heartrate_seconds_merged.csv` and checking the auto-detect box to automatically set the schema for this table, BigQuery tried to parse the `"Time"` column as TIMESTAMP data type. Due to the original format of `"Time"` column  is one that BigQuery cannot recognized as TIMESTAMP, it returns an error.  To fix this problem, rather than BigQuery auto detecting the schema of the table, I manually specified the schema in JSON format and defining the `"Time"` column as STRING data type instead of TIMESTAMP.
In order to figure out the name, data type and description of each column I referred to the document [Fitbit Data Dictionary](https://www.fitabase.com/media/2088/fitabase-fitbit-data-dictionary-as-of-4524.pdf). 05/20/2025
 
 
	    [  
			{  
				"description": "Id",  
				"mode": "NULLABLE",  
				"name": "Id",  
				"type": "INTEGER"  
			},  
			{  
				"description": "Time",  
				"mode": "NULLABLE",  
				"name": "Time",  
				"type": "STRING"  
			},  
			{  
				"description": "Value",  
				"mode": "NULLABLE",  
				"name": "Value",  
				"type": "INTEGER"  
			}  
		]

5. I uploaded the rest of tables through manually writing the schema in JSON format for the two datasets `FitabaseData_20160312-20160411` and `FitabaseData_20160412-20160512`.
    [Here](SchemaTables.md) you can find the code in JSON format that define the schema of the tables uploaded in BigQuery. Except for the tables `dailyCalories`,  `dailyIntensities`, and `dailySteps`. Their schema was created automatically by BigQuery due to it didn't have problems to parse them.
    05/21/2025
 
6. When uploading the tables into the dataset `FitabaseData_20160412-20160512`, I decided to add `_secondPeriod` at the end of each table's name to distinguish these tables from the tables of the `FitabaseData_20160312-20160411` dataset . It will avoid any confusion in the future when merging the tables. This is important because after downloading the datasets from Kaggle, I noticed that some table's name repeat across the two folders representing the same information but in different periods of time. 05/21/2025
   
    E.g.

   Original table names:
    
    	 `FitabaseData_20160312-20160411 -> heartrate_seconds_merged.csv`
    	 `FitabaseData_20160412-20160512 -> heartrate_seconds_merged.csv`
    	 
    Renamed tables after uploading in BigQuery: 
    
    	 `FitabaseData_20160312-20160411 -> heartrate_seconds.csv`
    	 `FitabaseData_20160412-20160512 -> heartrate_seconds_secondPeriod.csv`


7. **Checking for NULL values in each table**. In order to figure out how to address possible NULL values in the data, first I need to know if they exist at all and in what columns. I counted the null values for each column in each table of the project. [Here](checkingNulls.md) you can see the queries used and the results in each table. We discovered that only the table "weightLogInfo" in both datasets contain NULL values in the "Fat" column, which is the field for recording the body fat percentage. In the first dataset, 31 out of 33 rows contain NULL values and in the second one, 65 out of 67 rows. Even though some participants data was measured and synched automatically using a scale connected to the Fitbit account, it seems that the version of scale that they used wasn't able to measure and display any information about body fat percentage. Only two participants manually logged their body fat percentage through the system. Unfortunely, almost all records in this column contain NULL values, so I decided to remove this column for analysis. Body fat percentage could have been very useful to provide valuable insights about overall health and help make informed decisions about fitness and nutrition goals. Nevertheless, we still have information about BMI metrics and weight for analysis. 05/26/2025
   

**Before deciding which tables I will use for the analysis, I went over them to ensure data integrity, whether they provide accurate and complete information and are consistent with other tables**. 


8. **Checking for consistency between minute tables in each dataset**. Allegedlly, each minute table contains a specific metric (calories, steps, METs, intensities, and sleep). All these metrics were tracked simultaniously at the same time and for the same users (Id). Therefore, I decided to compare and see if the tables contain the same users Id and during the same time periods. For this task, I used SQL along with pivot tables in Google sheets. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/consistency.md#checking-for-consistency-between-calories-intensity-mets-steps-and-sleep-in-minute-tables) you will see the steps and results about the consistency between minute tables. The results shown that `minuteCalories`,`minuteIntensities`, `minuteMETs`, and `minuteSteps` are consistent between them in both datasets. These tables was contain the same time period and the same users. However, `minuteSleep` table is not consistent with the rest of minute tables, because only 22 out of the 33 participants logged sleep data. Hence, `minuteSleep` table will be analyze individually. 05/27/2025    

9. After ensuring the consistency within the minute tables, I proceeded to check the consistency within the hourly tables. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/consistency.md#checking-for-consistency-in-hour-tables-calories-intensity-and-steps) you can find the process and results done for checking consistency within hourly tables. We discovered that all hourly tables are consistent between them in both datasets. 05/27/2025

10. Afterward, I compared the minute and hourly tables to verify whether they represent the same data, but with different aggregated time measures. To do this, we can streamline the process by selecting just one minute table and one hourly table for the comparison. **I want to figure out if hourly tables were generated by agreggating the data from minutes to hours**. You can find the method and results for this comparison [here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/consistency.md#checking-for-consistency-minutes-vs-hourly-tables). We found that minute and hourly tables within the `FitabaseData_20160312_20160411` dataset are consistent, meaning they represent the same data. Although we observed differences in the total values between the `minuteCalories` and `hourlyCalories` tables for each user, this inconsistency is due to the data types: `minuteCalories` contains float values (with decimals), while `hourlyCalories` contains integer values. This is because the `minuteCalories` table was created by dividing the calories per hour values by 60, to represent the number of calories burned per minute, which results in decimal values. **Now that we know that minute and hourly tables tables are consistent, I decided to only use the hourly tables for analysis**
However, in the `FitabaseData_20160412_20160512` dataset, we found inconsistencies with the time period between the hourly and minute calories tables because some users stopped tracking their data at different dates. This led to inconsistent total values between the minute and hourly tables. This is unusual, since the hourlyCalories table was supposedly built on the minuteCalories data. **To address this inconsistency, we decided to not use the hourly tables from the second dataset, instead we will stick with the minute tables and based on them building the hourly tables by ourselves**. 05/28/2025

11. The `dailyActivity` table in each dataset contains daily totals for steps, intensity, distance, and calories. I assume that the minute and hourly tables are subsets of this table. If this table represents the same data as the minute and hourly tables, I might use it for analysis to draw insights about users’ daily activity, instead of grouping the data into days by manually using the minute and hourly tables. After checkig whether the `dailyActivity` table is consistent with minute and hourly tables, we discovered it is not. Although the `dailyActivity` table covers a time period very similar to the minute and hourly tables, the differences are significant enough to confirm that they are not fully consistent. You can check the process and results [here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/consistency.md#checking-consistency-in-dailyactivity-tables).
**The `dailyActivity` table is not consistent with the rest of minute and hourly tables. Therefore, I decided not to use it for our analysis, instead I will build a daily table using the minutes and hourly tables**. 05/29/2025

12. However, `hourlyintensities` tables don't contain the `SedentaryMinutes`, `LightlyActiveMinutes`, `FairlyActiveMinutes`, and `VeryActiveMinutes ` columns  to represent the time spent in one of four intensity categories:

Intensity value for the given minute.

0 = Sedentary

1 = Light

2 = Moderate

3 = Very Active


These colunmns are important for our analysis. Therefore, we will use the "minuteIntensities" tables from both datasets to calculate the values of these columns and add them in new "hourlyIntensities" tables. In other words, we a won't use the "hourlyIntensities" tables already present in the datasets. We will use the "minuteIntensities" tables for our analysis  to create the hourly and daily tables by ourselves. 05/29/2025

13. After ensuring the data is consistent across the tables in each dataset and they don't contain NULL values, the following tables will be used for the analysis:


 ### FitabaseData_20160312_20160411 dataset 

| Table  |
| --- |
| hourlyCalories |
| minuteIntensitiesNarrow |
| hourlySteps |
| minuteMETsNarrow |
| minuteSleep |
| weightLogInfo |



### FitabaseData_20160412_20160512 dataset

| Table |
| --- |
| minuteCaloriesNarrow_secondPeriod
| minuteIntensitiesNarrow_secondPeriod |
| minuteMETsNarrow_secondPeriod |
| minuteStepsNarrow_secondPeriod |
| minuteSleep_secondPeriod |
| weightLogInfo_secondPeriod |


14. For this analysis, it is important to draw insights and identify patterns throughout the entire survey period. Therefore, having a complete view of the data is essential. This means I need to merge the tables from the first dataset with those from the second. To do this, I will use the foreign key (user_id) contained in the tables. However, before merging, I need to verify whether the tables contain the same users across both datasets. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/Merging.md#checking-user-consistency-across-datasets-before-merging-tables) you will find the queries and results used for this cleaning process. 05/30/2025
    
    - weightLogInfo: more than half of the participants are missing weight data in one of the datasets, resulting in incomplete information. Additionally, I didn't observe any significant changes in users' weight during the two-month period. For the users who tracked their weight data, the data was recorded sporadically. Therefore, we decided to include all available weight data from both datasets, regardless of whether some users are missing weight information in one of them. Our goal is to use the weight data as an overall indicator of the participants' health status during the survey.  
    - minuteSleep: there are 3 out of 25 participants that are missing sleep data in one of the two datasets. However, this represents a small portion of the overall available sample (although the sample size itself is smaller than what is statistically recommended to fairly represent a population), we will merge the datasets to include only the users who are present in both datasets, resulting in a final sample of 22 participants.
    - calories, intensities, METs and Steps: there are 3 out of 35 participants who are missing data across these tables in one of the two datasets. Nevertheless, this does not represent a major issue in terms of completeness within the available sample. Therefore, we will merge the datasets to include only the users who are present in both datasets, resulting in a final sample of 32 participants.


15. Before merging the tables from both datasets, I will create the new "hourlyIntensities" tables based on the "minuteIntensitiesNarrow" tables.

**FitabaseData_20160312_20160411 dataset**

Query.

	SELECT
	  Id,
	  TIMESTAMP_TRUNC(activityMinute, HOUR) AS activityHour,
	  SUM(Intensity) AS TotalIntensity,
	  ROUND(AVG(Intensity), 1) AS AverageIntensity,
	  COUNTIF(Intensity = 0) AS SedentaryMinutes,
	  COUNTIF(Intensity = 1) AS LightlyActiveMinutes,
	  COUNTIF(Intensity = 2) AS FairlyActiveMinutes,
	  COUNTIF(Intensity = 3) AS VeryActiveMinutes 
	
	FROM ( 
	  SELECT 
	    Id,
	    PARSE_TIMESTAMP('%m/%d/%Y%I:%M:%S %p', ActivityMinute) AS activityMinute,
	    Intensity
	
	  FROM `analysisbellabeat246.FitabaseData_20160312_20160411.minuteIntensitiesNarrow`
	)
	
	GROUP BY Id, activityHour


I saved the results as a new table called `hourlyIntensities_complete` in this dataset.


**FitabaseData_20160412_20160512 dataset**

Query.

	SELECT
	  Id,
	  TIMESTAMP_TRUNC(activityMinute, HOUR) AS activityHour,
	  SUM(Intensity) AS TotalIntensity,
	  ROUND(AVG(Intensity), 1) AS AverageIntensity,
	  COUNTIF(Intensity = 0) AS SedentaryMinutes,
	  COUNTIF(Intensity = 1) AS LightlyActiveMinutes,
	  COUNTIF(Intensity = 2) AS FairlyActiveMinutes,
	  COUNTIF(Intensity = 3) AS VeryActiveMinutes 
	
	FROM ( 
	  SELECT 
	    Id,
	    PARSE_TIMESTAMP('%m/%d/%Y%I:%M:%S %p', ActivityMinute) AS activityMinute,
	    Intensity
	
	  FROM `analysisbellabeat246.FitabaseData_20160412_20160512.minuteIntensitiesNarrow_secondPeriod` 
	)
	
	GROUP BY Id, activityHour


I saved the results as a new table called `hourlyIntensities_secondPeriod_complete` in this dataset.


16. I merged the following tables from the two datasets to get the new merged tables for the analysis. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/Merging.md#merging-tables) you will find the file with the queries performed to merge the tables. 05/31/2025
    
    | Table || Result |
    | --- | --- | --- |
    | weightLogInfo | weightLogInfo_secondPeriod | weight_data |
    | minuteSleep | minuteSleep_secondPeriod | minuteSleep_merged |
    | hourlyCalories | minuteCaloriesNarrow_secondPeriod | hourlyCalories_merged |
    | hourlyIntensities_complete | hourlyIntensities_secondPeriod_complete | hourlyIntensities_merged |
    | hourlySteps | minuteStepsNarrow_secondPeriod | hourlySteps_merged |
    | minuteMETsNarrow | minuteMETsNarrow_secondPeriod | minuteMETs_merged |

17. After merging the tables from the two datasets, I checked for extra spaces or characters across the records of each merged table. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/cleaning.md#extra-spaces-in-data) you can find all the queries and steps performed to check for extra spaces in the merged tables. **We didn't find any extra spaces or characters in the columns**. 06/01/2025

18. Finally, I checked for duplicates in the merged tables to finish the cleaning process of this data. [Here](https://github.com/aldopando/BellabeatCaseStudy/blob/main/cleaning.md#duplicates-in-data) you will find the process and results for cleaning duplicates in the data. Since BigQuery doesn't allow updates or deletions of individual rows in standard tables, we will create a dataset that will storage the cleaned version of the tables that contain only distinct rows. This dataset is named `clean_data`. 06/02/2025
    
	- hourlyCalories_merged: 175 duplicate rows were removed.
  	- hourlyIntensities_merged: 175 duplicate rows were removed.
	- hourlySteps_merged:  175 duplicate rows were removed.
	- minuteMETs_merged: 10,500 duplicate rows were removed.
	- weight_data: 2 duplicate rows were removed.
  	- minuteSleep_merged: 4,300 duplicate rows were removed.


### Clean_data dataset

| Table |
| --- | 
| hourlyCalories_cleaned |
| hourlyIntensities_cleaned |
| hourlySteps_cleaned |
| minuteMETs_cleaned |
| weight_data_cleaned |
| minuteSleep_cleaned |


## Analysis

### Aggregating METs from minutes to hours

For this analysis, we will aggregate the data in the `minuteMETs_cleaned` table from minutes to hours in order to merge it along with the other variables (calories, intensities and steps). We will save the results as a new table called `hourlyMETs_cleaned` in our `clean_data` dataset.

To aggregate the variable METs, we will have to sum all MET minutes a person expends during an hour. 

Important: All MET values exported from Fitabase are multiplied by 10. Therefore, we will divide by 10 to get accurate MET values.

Example: 10 = 1.0 METs; 38 = 3.8 METs


**What is a MET?**

MET stands for Metabolic Equivalent of Task. It is a unit that measures how much energy an activity consumes compared to being at rest. Low-intensity exercises have a lower MET value while high-intensity physical activities have a high MET score.

**Levels of MET**

We can differentiate 3 categories of physical activity:

- Light-intensity activities – under 3 MET.
- Moderate–intensity activities – from 3 to 6 MET.
- Vigorous–intensity activities – over 6 MET.

**What is a MET minute?**

Met-Minutes are used to determine the amount of energy expended during a workout or activity. A MET minute is the amount of energy expended during a minute while at rest.  You can, however, burn more than one MET minute in a minute depending on the intensity of the activity.

**MET minutes per week**

The amount of MET minutes per week tells you how much energy you have expended while performing various activities throughout the whole week.


**World Health Organization guidelines on physical activity and sedentary behaviour**

Currently, the [World Health Organization](https://www.who.int/publications/i/item/9789240015128) recommends adults to meet a minimum physical activity: 

- Adults should aim for at least 150 minutes of moderate-intensity activity or 75 minutes of vigorous-intensity activity per week for minimal health benefits. 
- For additional health benefits, adults should increase their moderate-intensity physical activity to 300 minutes per week or an equivalent

According to [the Skeptical Cardiologist](https://theskepticalcardiologist.com/2021/01/17/the-compendium-of-physical-activities-mets-for-all/) article:
Moderate-intensive activities are ones that cause you to consume at least three times but no more than six times as much energy per minute as you do at rest. Thus moderate intensity exercises or activities are those which require 3-6 METS like walking at 3-4 MPH.

Vigorous activities such as running at >6 MPH burn > 6 METS.

**how many MET minutes is enough?**

Accordig to [omni calculator](https://www.omnicalculator.com/sports/met-minutes-per-week?utm_source=chatgpt.com) website:

MET-minutes/week is a measure used to quantify intentional physical activity, not basic physiological processes like sleeping or resting. Only activities over 3 MET can be considered when counting active minutes per week.

This means that you need at least 450 MET minutes per week to meet these recommendations. Moreover, if we take into account the second recommendation to achieve extra health benefits, you should achieve at least 900 MET minutes per week.

***Therefore, to calculate the MET-minutes for each user in this case study, we will only count the values equal or greater than 3 METs for a more accurate approach to physical activity.*** 


Query.


	CREATE TABLE clean_data.hourlyMETs_cleaned AS
	
	SELECT 
	
	  Id,
	  TIMESTAMP_TRUNC(activityMinute, HOUR) AS activityHour,
	  SUM(CASE WHEN METs/10 > 3 THEN METs ELSE 0 END)/10 AS MET_minutes
	
	FROM `analysisbellabeat246.clean_data.minuteMETs_cleaned` 
	
	GROUP BY Id, TIMESTAMP_TRUNC(activityMinute, HOUR)

---



### Merging hourly tables (calories, intensities, steps, and METs) + Sorting the data.

**We created a new dataset called `analysis` to save all the results after performing calculations and aggregating the data**.


Query. 

	SELECT  
	  calories.Id,
	  calories.activityHour,
	  calories.Calories,
	  intensities.TotalIntensity,
	  intensities.SedentaryMinutes,
	  intensities.LightlyActiveMinutes,
	  intensities.FairlyActiveMinutes,
	  intensities.VeryActiveMinutes,
	  METs.MET_minutes,
	  steps.StepTotal
	
	FROM `analysisbellabeat246.clean_data.hourlyCalories_cleaned` AS calories
	
	LEFT JOIN `analysisbellabeat246.clean_data.hourlyIntensities_cleaned` AS intensities 
	  ON calories.Id = intensities.Id 
	  AND calories.activityHour = intensities.activityHour
	
	LEFT JOIN `analysisbellabeat246.clean_data.hourlyMETminutes_cleaned` AS METs 
	  ON calories.Id = METs.Id 
	  AND calories.activityHour = METs.activityHour
	
	LEFT JOIN `analysisbellabeat246.clean_data.hourlySteps_cleaned` AS steps
	  ON calories.Id = steps.Id 
	  AND calories.activityHour = steps.activityHour
	
	ORDER BY Id, activityHour



***We saved the results as a new table called `hourlyActivity` in our `analysis` dataset***


**Verifying number of rows**

| hourlyCalories_cleaned | hourlyIntensities_cleaned | hourlyMETs_cleaned | hourlySteps_cleaned | hourlyActivity  |
| --- | --- | --- | --- | --- |
| 44,580 | 44,580 | 44,580 | 44,580 | 44,580 |




### Aggregating the data in the `hourlyActivity` table from hours to days + Sorting the data.


	SELECT  
		Id,
		DATE(TIMESTAMP_TRUNC(activityHour, DAY)) AS activityDate,
		SUM(Calories) AS calories,
		SUM(TotalIntensity) AS totalIntensity,
		SUM(SedentaryMinutes) AS sedentaryMinutes,
		SUM(LightlyActiveMinutes) AS lightlyActiveMinutes,
		SUM(FairlyActiveMinutes) AS fairlyActiveMinutes,
		SUM(VeryActiveMinutes)AS veryActiveMinutes,
		CAST(SUM(MET_minutes) AS INT64) AS MET_minutes,
		SUM(StepTotal) AS totalSteps
		
		
	FROM `analysisbellabeat246.analysis.hourlyActivity` 
		
	GROUP BY Id, activityDate
	ORDER BY Id, activityDate


***We saved the results as a new table called `dailyActivity` in our `analysis` dataset***




### Patterns in period time across all users.


**Oldest date**


Query.
	
	SELECT  
	
	  MIN(activityHour) AS oldest_date
	
	FROM `analysisbellabeat246.analysis.hourlyActivity` 


Results.

| oldest_date | 
| --- | 
| 2016-03-12 00:00:00.000000 UTC |


We counted how many users started to track their data in the date 2016-03-12.

Query.

	SELECT 
		COUNTIF(oldest_date = '2016-03-12') AS oldest_date_2016_03_12
		
	FROM (
		SELECT  
		  Id,
		  MIN(activityDate) AS oldest_date
		
		FROM `analysisbellabeat246.analysis.dailyActivity` 
		
		GROUP BY Id
	)


Results.

| oldest_date_2016_03_12 | 
| --- |
| 32 |

**All participants started to track their data in the same date**.
 
---

**Latest date**

First, we found the latest date in the table indicating the maximum date a user finished tacking their data.

Query.

	SELECT  
	  MAX(activityDate) AS latest_date
	
	FROM `analysisbellabeat246.analysis.dailyActivity` 
 

 Results.

| latest_date |
| --- |
| 2016-05-12 |


We counted how many users finished to track their data in the date 2016-05-12.


Query. 

	SELECT 
	  COUNTIF(latest_date = '2016-05-12') AS latest_date_2016_05_12
	
	FROM (
	  SELECT  
	    Id,
	    MAX(activityDate) AS latest_date
	
	  FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	  GROUP BY Id
	)


Results.

| latest_date_2016_05_12 |
| --- |
| 18 |


Observations.

***Only 18 out of 32 participants finished to track their data until 2016-05-12. This means that some users finished to track their data earlier than expected***.


### Number of users that weekly tracked their data throughout the period time (March 12 to May 12).


We grouped the days and assinged them into a corresponding week. The first week started since 2016-03-12. Every week contains 7 days, except the week 9 which contains only 6 days.

Query.

	SELECT 
	  CASE 
	  WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	  WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	  WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	  WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	  WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	  WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	  WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	  WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8'
	  ELSE 'Week 9'   
	  END AS week,
	  COUNT(DISTINCT(Id)) AS active_users
		
	FROM `analysisbellabeat246.analysis.dailyActivity` 
		
	GROUP BY week
	ORDER BY week

---

![image](https://github.com/user-attachments/assets/472a1897-b50e-4115-9d8c-69163e2759e3)


Observations.

- ***We can observe a considerable decline of users that were consistently tracking their data in the end of the second month (week 7 to week 9)***.


---

## Inactivity patterns.


**First approach**.

We know that all Fitbit devices track **steps** taken. When a person is using their wearable, it automatically starts to tracked their steps. 

We can assumme that a person using their wearable can accomplish a minimum amount of steps during a day that is different from zero, even for a sedentary person. If the value of steps taken is zero, it means the user is not using their wearable at all. Therefore, we can pinpoint the users who didn't wear their devices in specifc days by identifying if they got zero steps taken.

Therefore, we will filter all the rows where total steps were zero in our `dailyActivity` table and observe what values were tracked in the other variables when this happened. 

Query. 

	SELECT *

	FROM `analysisbellabeat246.analysis.dailyActivity`
	
	WHERE totalSteps = 0
	
	ORDER BY MET_minutes DESC



We sorted the data by MET-minutes to identify any outlier because our hypothesis is that if a user got zero steps during a day, it means they weren't using their wearable, Therefore, their devices couldn't have tracked any intensity (physical activity) either.


<img width="1740" height="644" alt="image" src="https://github.com/user-attachments/assets/369b3947-d8b9-44b7-8bc9-7488a2818e36" />

---

- ***We found two users whose devices tracked high intensity levels and MET-minutes even though they got zero steps in that day. We can infer that they only used their wearables to tracked a non-step activity such as weight lifting. We know that the devices that can tracked heart rate data are particularly useful for activities that are not easily tracked by steps alone, such as weightlifting, yoga, swimming, or rowing.***

  
**Second approach**

We cannot only base on steps taken variable to identify inactivity patterns, because there were users who were involved in non-step activities. Therefore, to fairly identify users totally inactive (they weren't using their wearables in certain days at all) we need to filter:

Users who got 0 steps taken AND 0 total intensity AND 0 MET-minutes in a day.

Query.

	SELECT *
	
	FROM `analysisbellabeat246.analysis.dailyActivity`
	
	WHERE totalSteps = 0 AND totalIntensity = 0 AND MET_minutes = 0
	
	ORDER BY MET_minutes DESC



<img width="1808" height="328" alt="image" src="https://github.com/user-attachments/assets/a5a66c25-9f1f-4a0b-92dd-ee3e6431e613" />


- ***We found 220 rows of non-activity (days when users weren't using their wearables)***.
- ***We can still see values in the `calories` column because these are representing the BMR value which stands for basal metabolic rate. This is the number of calories a person's body naturally spends to stay alive. This value is calculated automatically by the system (even though the user isn't using the wearable) based on information logged about users' physical characteristics such as age, sex, height, and weight***.
- ***We can still see values in the `sedentaryMinutes` column because sedentary minutes column sum all intensity values that are equal to zero. And it makes sense, because 1440 minutes represents 24 hours, meaning 24 hours of 0 intensity.***.
  

---

**To fairly draw insights from the data, we need to only take into account the days when the participants were using their devices**.

---

## Inactivity by day of the week.

We are going to figure out what days there were more inactivity levels (when participants didn't use their wearables). 

Query.

	WITH inactivity_days AS (
	
	  SELECT 
	    Id,
	    activityDate,
	    FORMAT_DATE('%A', activityDate) AS day_of_the_week
	
	  FROM `analysisbellabeat246.analysis.dailyActivity`
	
	  WHERE totalSteps = 0 AND totalIntensity = 0 AND MET_minutes = 0
	
	  ORDER BY Id, activityDate
	)
	
	SELECT 
	  day_of_the_week,
	  COUNT(Id) AS inactive_users
	
	FROM inactivity_days
	
	GROUP BY day_of_the_week
	ORDER BY inactive_users

 ![image](https://github.com/user-attachments/assets/a4a9a00f-9191-40f4-9ea7-a93d7dd73b8d)


 **Observations**.

 - ***The days with more inactivity (when users didn't use their device at all) were Saturday and Sunday***.
 - ***Monday and Tuesday were the days with high levels of inactivity as well***.
 - ***Friday is the day when users were using their devices more consistenly*** .




### Steps

**Weekly inactivity patterns: days with 0 steps**.

First off, we will create a table that contains the users who tracked 0 steps in any day throughout the two months period. Moreover, we will count how many days each user happen to have 0 steps during each week.

Query.

	SELECT 
	  Id,
	  CASE
	  WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	  WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	  WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	  WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	  WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	  WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	  WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	  WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8'
	  ELSE 'Week 9'
	  END AS week,
	  COUNTIF(TotalSteps = 0) AS totalDays_notStepsTracked
	
	
	FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	GROUP BY Id, week
	HAVING COUNTIF(TotalSteps = 0) > 0
	ORDER BY Id, week



![image](https://github.com/user-attachments/assets/5d2d36ec-7a34-4904-86b0-6931a7cbd7de)


---

Observations
- ***We can observe that 6 users got zero steps taken for a whole week, this means that 6 users didn't use their wearables during that week***.
- ***We can also see that 20 participants stopped using their devices at some point of the period time***.
- ***4 users tracked zero steps for two whole weeks. In other words, four participants didn't use their wearable at all for two weeks***.

---

Now we will group our users who didn't give any step based on how many days they were inactive, and we will count the total users in each group by week.

Query.

	SELECT 
	  week,
	  COUNTIF(totalDays_notStepsTracked = 7) AS seven_days,
	  COUNTIF(totalDays_notStepsTracked = 6) AS six_days,
	  COUNTIF(totalDays_notStepsTracked = 5) AS five_days,
	  COUNTIF(totalDays_notStepsTracked = 4) AS four_days,
	  COUNTIF(totalDays_notStepsTracked = 3) AS three_days,
	  COUNTIF(totalDays_notStepsTracked = 2) AS two_days,
	  COUNTIF(totalDays_notStepsTracked = 1) AS one_day,
	
	FROM (
	  SELECT 
	    Id,
	    CASE
	    WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	    WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	    WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	    WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	    WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	    WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	    WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	    WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8'
	    ELSE 'Week 9'
	    END AS week,
	    COUNTIF(TotalSteps = 0) AS totalDays_notStepsTracked
	
	  FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	  GROUP BY Id, week
	  HAVING COUNTIF(TotalSteps = 0) > 0
	  ORDER BY Id, week
	)
	
	GROUP BY week
	ORDER BY week


![image](https://github.com/user-attachments/assets/821f8760-ffe1-4ffa-b208-f26bbf6807f2)


Observations.

- ***We can observe a peak of 5 users who didn't give any steps during 7 days (an entire week) in the week 2***.
- ***The week with most inactive users was the second***.
- ***During the week 5, there were less inactive users, meaning the users were using their wearable more frequently compared to other weeks***.


**Average daily steps by user**

According to [10000 Steps](https://www.10000steps.org.au/learn-and-discover/counting-steps/#:~:text=Sedentary%20is%20less%20than%205%2C000,is%20approximately%203%2C000%20%2D%204%2C000%20steps.), studies using the 10,000 steps per day goal have shown weight loss, improved glucose tolerance, and reduced blood pressure from increased physical activity toward achieving this goal. 

However, a general guideline for daily physical activity based on step count is:

- Sedentary is less than 5,000 steps per day. 
- Low active is 5,000 to 7,499 steps per day.
- Somewhat active is 7,500 to 9,999 steps per day.
- Active is more than 10,000 steps per day.
- Highly active is more than 12,500  steps per day.


To fairly draw insights from the analysis we will filter out only the values tracked when the participants were using their wearables, meaning when they didn't get 0 steps, 0 MET-minutes and 0 total intensity.


Query.

	SELECT  
	  Id,
	  ROUND(AVG(TotalSteps), 0) AS average_TotalSteps
	
	FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	GROUP BY Id
	ORDER BY Id


![image](https://github.com/user-attachments/assets/314cb4bc-af77-46fb-8ef0-b34ccaa0b143)

 
Observations.

- ***We can observe that on average 8 participants reached the daily goal of 10,000 steps for a good overall health, representing the 25% of the total sample***.
- ***It means that 75% are under the daily goal of 10,000 steps. However, this goal is not universally appropriate across all ages and physical function. Besides that, we are not taking into account non-step activities***.

---

Query.

	SELECT 
	  CASE
	  WHEN average_TotalSteps < 5000 THEN 'Sedentary'
	  WHEN average_TotalSteps BETWEEN 5000 AND 7499 THEN 'Low active'
	  WHEN average_TotalSteps BETWEEN 7500 AND 9999 THEN 'Somewhat active'
	  WHEN average_TotalSteps BETWEEN 10000 AND 12499 THEN 'Active'
	  ELSE 'Highly active'
	  END AS physical_activity,
	  COUNT(Id) AS number_of_users
	
	FROM(
	  SELECT  
	    Id,
	    ROUND(AVG(TotalSteps), 0) AS average_TotalSteps
	
	  FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	  WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	  GROUP BY Id
	  ORDER BY Id
	)
	GROUP BY physical_activity
	ORDER BY number_of_users DESC


![image](https://github.com/user-attachments/assets/71535f91-2858-45cd-ad20-8cad54397c9f)


Observations.

- ***We can observe that 21% of the participants are involved in sendentary lifestyle based on their daily average steps***.
- ***28% of participants are somewhat active users***.
- ***47% (almost the half) of users are sedentary and low active***.
- ***25% of users have an average daily activity between active and highly active***.

---

**Average steps by day of the week**

Query.

	WITH inactivity_days AS (

	  SELECT 
	    Id,
	    activityDate,
	    FORMAT_DATE('%A', activityDate) AS day_of_the_week,
	    totalSteps
	
	  FROM `analysisbellabeat246.analysis.dailyActivity`
	
	  WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	  ORDER BY Id, activityDate
	)
	
	SELECT 
	  day_of_the_week,
	  CAST(AVG(totalSteps) AS INT64) AS average_steps
	
	FROM inactivity_days
	
	GROUP BY day_of_the_week
	ORDER BY average_steps


![image](https://github.com/user-attachments/assets/17944b1f-e86b-4d6a-85ea-da255c9a272a)


Observations.

- ***Saturday was the day when users gave more steps throughout the week on average followed by Tuesday***.
- ***Sunday and Friday were the days when the users gave less steps on average***.
- ***We can notice a consistent increment of steps taken from Sunday to Tuesday, reaching the peak on Tuesday***.
- ***From Tuesday to Friday we can observe a consistent decrement in steps taken***.


---



 ### Users Meeting the 600 MET-Minutes Recommendation

- Users under 600 MET-minutes per week are not enough active to keep healthy lifestyle. They are not getting health benefits.
- Users over 600 MET-minutes per week are meeting the MET-minutes necessary for a good overall health. Besides maintaining a good health, the more MET-minutes accomplish during the week, the more health benefits.


Due to we are calculating MET-minutes per week, we need to fairly calculate this value through using full weeks. Therefore, we will filter only the users who logged physical activity for all 7 days in each week. This is important to fairly compare users who were consistent tracking their data throughout the full week.


Query.

	WITH weekly_METminutes AS (
	  SELECT
	    Id, 
	    CASE 
	    WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	    WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	    WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	    WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	    WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	    WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	    WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	    WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8'
	    ELSE 'Week 9'    
	    END AS week,
	    COUNT(DISTINCT activityDate) AS active_days, -- count days user was active in week
	    SUM(MET_minutes) AS METs_minutes
	
	  FROM `analysisbellabeat246.analysis.dailyActivity`
	
	  WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	  
	  GROUP BY Id, week
	),
	
	filtered_weeks AS (
	  SELECT
	    Id,
	    week,
	    METs_minutes
	    
	  FROM weekly_METminutes
	
	  WHERE active_days = 7 -- keep only users with 7 active days in the week
	)
	SELECT
	  week,
	  COUNTIF(METs_minutes < 600) AS goal_notAchieved,
	  COUNTIF(METs_minutes >= 600) AS goal_achieved
	
	FROM filtered_weeks
	
	GROUP BY week
	ORDER BY week



![image](https://github.com/user-attachments/assets/9a707c3c-1f13-4992-b86d-986aa11cca0d)


Observations.

- ***We can observe that the vast majority of participants achieved their MET-minutes/week recommendation for minimun physical activity to maintain their overall health. However, this doesn't tell us that these participants are involved in consistent high levels of physical activity or they are even getting extra health benefits like loosing weight or achieving their fitness goals***.
- ***We can notice that between 19 to 24 participants tracked their data consistenly completing full weeks using their wearables***.
- ***Week 9 doesn't appear in the results because this week only contains 6 days. It doesn't represent a full week, therefore we cannot draw fair MET-minutes/week results***.
- ***The last week of the first month (week 4) was not only the week with more users reaching their goal of 600 MET-minutes per week, but it also was the week with more users wearing their devices more consistenly***.
  

### Physical Activity by Week

**Grouping data by week and physical activity**

To categorize the physical activity of users for this analysis, we will follow the MET-minutes/week categories created by this [study](https://www.healthdata.org/sites/default/files/methods_appendices/2021/lojustin_activity_writeup_gbd2020_AC_updated0131.pdf)

Physical activity level is categorised by total MET-minutes per week using four categories based on rounded values closest to the quartiles of the global distribution of total MET-minutes/week. The physical activity categories are defined in terms of weekly MET-mins as below:

• Level 0: <600 MET-min/week (inactive).

• Level 1: 600–3999 MET-min/week (low-active).

• Level 2: 4000–7,999 MET-min/week (moderately active).

• Level 3: ≥8,000 MET-min/week (highly active).



Query.

	WITH weekly_METminutes AS (
	  SELECT
	    Id,
	    CASE 
	    WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	    WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	    WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	    WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	    WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	    WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	    WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	    WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8'
	    ELSE 'Week 9'    
	    END AS week,
	    COUNT(DISTINCT activityDate) AS active_days, -- count days user was active in week
	    CASE 
	    WHEN SUM(MET_minutes)<600 THEN 'Inactive'
	    WHEN SUM(MET_minutes) BETWEEN 600 AND 3999 THEN 'Low-active'
	    WHEN SUM(MET_minutes) BETWEEN 4000 AND 7999 THEN 'Moderately-active'
	    ELSE 'Highly-active' 
	    END AS physical_activity
	      
	  FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	  WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	  GROUP BY Id, week
	  ORDER BY Id, week
	)
	
	SELECT
	
	  week,
	  COUNT(Id) AS number_of_users,
	  physical_activity
	
	
	FROM weekly_METminutes
	
	WHERE active_days = 7 --keep only users with 7 active days in the week
	
	GROUP BY week, physical_activity
	ORDER BY week, physical_activity


 ---


![image](https://github.com/user-attachments/assets/64160dd0-469d-4efe-8cae-89b18a146eb3)


Observations.

- ***We can observe a peak of 14 low-active users during the first week of the first month***.
- ***The weeks with more highly-active users were the week 1 and 4***.
- ***We can see a gradual increment of moderately-active users from week 1 to week 3, aftwerward the number of people moderately-active remains the same until the week 7 when there is peak of 10 moderately-active users, then this number drops in the week 8***.


---

![image](https://github.com/user-attachments/assets/308b24ea-75ba-4136-abdd-fdf47e21d259)


Observations.

1. Low-active users (red):

- It starts high at 14 users in Week 1.
- Sharp drop to 10 users in Week 2.
- Then fluctuates slightly between 10–12 users until Week 5.
- Gradual decline again to 10 users in weeks 6–8.

***There’s a clear downward trend, suggesting a slight shift of users away from the low-active category over time. Possibly some users moved up to moderately active***.

2. Moderately-active users (yellow).

- There is a steady increment of users in weeks 1-3.
- The number of users remain the same during weeks 3-6.
- There is a peak of 10 users in week 7.
- Sharp drop to 8 users in Week 8.

***There is a strong upward trend during weeks 1-7, reaching the peak of users moderately-active in week 7. This group is growing over time, especially during the first half. This indicates a positive trend where users are increasing their activity levels.***


3. Highly-active users (green).

- It starts at 4 users and fluctuates slightly during the first month (weeks 1-4) finishing with the same number of users as in the beginning.
- There is a drop to 2 users when starting off the second month (week 5).
- Then it fluctuates slightly again between 3–2 users until Week 8.

***There is a clear downward trend over the time of highly-active users. Highly active users reamin as the smallest group and there were even users that may have reduced their levels of activity over the time***.



---

**Physical Activity by Average MET-minutes/week**

Query.

	WITH weekly_METminutes AS(
	  SELECT
	  Id,
	  CASE 
	  WHEN activityDate BETWEEN '2016-03-12' AND '2016-03-18' THEN 'Week 1'
	  WHEN activityDate BETWEEN '2016-03-19' AND '2016-03-25' THEN 'Week 2'
	  WHEN activityDate BETWEEN '2016-03-26' AND '2016-04-01' THEN 'Week 3'
	  WHEN activityDate BETWEEN '2016-04-02' AND '2016-04-08' THEN 'Week 4'
	  WHEN activityDate BETWEEN '2016-04-09' AND '2016-04-15' THEN 'Week 5'
	  WHEN activityDate BETWEEN '2016-04-16' AND '2016-04-22' THEN 'Week 6'
	  WHEN activityDate BETWEEN '2016-04-23' AND '2016-04-29' THEN 'Week 7'
	  WHEN activityDate BETWEEN '2016-04-30' AND '2016-05-06' THEN 'Week 8' 
	  END AS week, 
	  COUNT(DISTINCT activityDate) AS active_days,
	  SUM(MET_minutes) AS METminutes
	      
	  FROM `analysisbellabeat246.analysis.dailyActivity`
	
	  WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	  GROUP BY Id, week
	  ORDER BY Id, week
	)
	
	SELECT 
	  Id,
	  CASE 
	  WHEN AVG(METminutes)<600 THEN 'Inactive'
	  WHEN AVG(METminutes) BETWEEN 600 AND 3999 THEN 'Low-active'
	  WHEN AVG(METminutes) BETWEEN 4000 AND 7999 THEN 'Moderately-active'
	  ELSE 'Highly-active' 
	  END AS physical_activity,
	  CAST(AVG(METminutes) AS INT64) AS weekly_average_METminutes,
	
	FROM weekly_METminutes
	
	WHERE active_days = 7
	
	GROUP BY Id
	ORDER BY Id



![image](https://github.com/user-attachments/assets/8aebdee7-960c-4842-a1e0-d6c0cd4827ca)


According to [Medscape](https://www.medscape.com/viewarticle/867293), the more total regular daily physical activity one engages in — including recreation, transportation, occupational activity, and/or daily chores — the lower the risks for breast cancer, colon cancer, diabetes, ischemic heart disease, and ischemic stroke. However, significant reductions in those conditions were seen only with total activity levels considerably higher than the minimum 600 metabolic equivalent (MET) minutes per week recommended by the World Health Organization. That 600 METs equates to about 150 minutes/week of brisk walking or 75 minutes/week of running. 

With the development of diabetes, for example, compared with no physical activity, those with 600 MET minutes per week (the minimum recommended level of activity) had a 2% lower risk. That risk reduction jumped by an additional 19% with an increase from 600 to 3600 METs/week. Gains were smaller above that, with the increase of total activity from 9000 to 12,000 MET minutes/week yielding only an additional 0.6% diabetes reduction.

Overall, compared with insufficiently active individuals (total activity < 600 MET minutes/week), the risk reduction for those in the highly active category (≥ 8000 MET minutes/week) was 14% for breast cancer; 21% for colon cancer; 28% for diabetes; 25% for ischemic heart disease; and 26% for ischemic stroke. 
Risks of the five conditions dropped significantly with an increase in MET minutes per week from 600 to 3000 to 4000, with less additive benefit seen above that level.


<img width="300" height="192" alt="image" src="https://github.com/user-attachments/assets/f5ce2bd4-ce39-4f35-ae55-cb48e1557f6a" />



Observations:

1. 600–3999 MET-min/week (low-active users).
   
- ***This is the largest group in the data with 18 users. Although they were involved in low physical activities, they not only achieved the minimum WHO recommendation, but they also were still gaining sustantial health benefits***.
- ***12 users achieved in average 600-3000 MET-minutes/week***.
- ***6 users achieved in average 3000-4000 MET-minutes/week***.

2. 4000–7,999 MET-min/week (moderately active users).

- ***A smaller but still substantial number of users are in the moderately-active group with 11 users in total. This group are not only gaining sustantial health benefits, but research shows the largest gains in disease prevention***.
- ***8 users are achieving in average 4000-6000 MET-minutes/week***.
- ***3 users are achieving in average 6000-8000 MET-minutes/week***.

4. ≥8,000 MET-min/week (highly active users).

- ***This is the smallest group with 2 users in total. There a big difference of almost 2000 MET-minutes/week between the user with more MET-minutes/week in moderately-active group with the user with less MET-minutes/week in the highly-active group***.
- ***The two users are not only achieving 8000 MET-minutes/week, but they are even reaching range between 9000-10000 MET-minutes/week***.
- ***Research suggests that health gains above 8,000 MET-min/week are smaller. For example, the diabetes risk drops only slightly (0.6%) when increasing from 9,000 to 12,000 MET-min/week***.



  
---

![image](https://github.com/user-attachments/assets/69c5735f-f715-403a-8706-79cac16cc59e)


Observations.

- ***More than half participants of the whole sample are low-active users, representing the 58%***.
- ***More than a third part of the total users are moderately-active***.
- ***A very small percentage of users are highly-active, representing only 6% of the whole***.

---


### Calories

The number of calories a person burn in a day depends on several factors such as:

- age
- sex
- height
- weight
- physical activity


***What is BMR?***

BMR stands for basal metabolic rate. It is the number of calories a person needs to stay alive. This includes basic functions such as:

- breathing
- heart rate and blood flow
- metabolism (digestion and nutrient absorption)
- cell function, growth, and repair


---

Due to lack of overall information about users' physical characteristics such as age, sex, height, and weight for this analysis, we cannot accurately determine whether the calories burnt by each user is aligned with their personal needs and goals. 

---


## Correlation between the variables Calories vs Steps / Calories vs Intensity

A correlation is a statistical measure that indicates a relationship between two variables, meaning they change together.

Using a scatterplot, we can generally assess the relationship between the variables and determine whether they are correlated or not.

The correlation coefficient is a value that indicates the strength of the relationship between variables. The coefficient can take any values from -1 to 1. The interpretations of the values are:

- -1: Perfect negative correlation. The variables tend to move in opposite directions (i.e., when one variable increases, the other variable decreases).
- 0: No correlation. The variables do not have a relationship with each other.
- 1: Perfect positive correlation. The variables tend to move in the same direction (i.e., when one variable increases, the other variable also increases).

***The closer 𝑟 is to +1, the stronger the positive linear relationship between the two variables.*** However, just because 𝑟 is high doesn’t mean one variable causes the other. 

**Correlation and Causation**
Correlation must not be confused with causality. The famous expression “correlation does not mean causation” is crucial to the understanding of the two statistical concepts.

If two variables are correlated, it does not imply that one variable causes the changes in another variable. Correlation only assesses relationships between variables, and there may be different factors that lead to the relationships. Causation may be a reason for the correlation, but it is not the only possible explanation.



Query. 

	SELECT  
	  Id,
	  activityDate,
	  calories,
	  totalSteps,
	  totalIntensity
	
	FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	ORDER BY Id, activityDate


**Calories vs Steps**


![image](https://github.com/user-attachments/assets/3c36840e-e313-4bb2-9f07-ec12cca4b1e7)

---

Observations:

**Moderate positive relationship (R² = 0.508)**.

- The R-squared of 0.508 means about 50.8% of the variation in total calories burned is explained by total steps.
- This is a strength relationship lower than relationship between total calories and total intensity (R² = 0.61).
- It suggests steps alone are not as strong predictor of calories burned compared to total intensity, likely because steps don’t capture activity intensity (for example, walking vs running) or because some participants were more involved in non-step activities like weight lifting or yoga that may not be well-represented by steps alone.
- The p-value < 0.0001 means the positive relationship between steps and calories burned is statistically significant.
- The trendline is unlikely to be due to chance.
  
Outliers:

- Some users burned fewer calories than expected for their step counts (below the trendline), perhaps walking at low intensity.
- Others burned more calories than expected (above the trendline), possibly due to higher intensity activities or greater body mass.


**Calories vs Intensity**

![imagw](https://github.com/user-attachments/assets/810b3b85-f3f7-4ea7-87fa-d70e6c9f32d7)

---

Observations:

**Strong positive relationship (R² = 0.61)**.

- The trend line has an R-squared value of 0.613, which means about 61% of the variation in total calories burned can be explained by total intensity levels.
- This is a moderately strong relationship between these two variables.
- The remaining 39% of variation could be due to other factors (e.g., body composition, metabolism, age, diet).
- The p-value < 0.0001 indicates the relationship is statistically significant. This means there is strong evidence that total intensity and total calories burned are positively related and the trendline is not random.

Outliers.

- Some users burned more calories than expected for their intensity (above the trendline). This can possibly be due to body composition, metabolism, age, diet,  inefficient movement, etc.
- Others burned fewer calories than expected (below the trendline). Perhaps due to body composition, metabolism, age, diet, more efficient movement, etc.

  

## Sleep

Sleep is a vital natural process that allows the body and mind to rest and recover. Sleep is regulated by your circadian rhythm, and its importance extends to cognitive, emotional, and physical health.

The sleep cycle consists of distinct stages, including NREM and REM sleep, each with a specific role in maintaining your health.



**What Are Sleep Cycles?**

During a night of sleep, your body cycles through four stages of sleep. The first three stages are called non-rapid eye movement (NREM) sleep and the final stage is called rapid eye movement (REM) sleep. Each stage is associated with a different depth of sleep as well as specific patterns in brain waves and muscle activity in the body.

Your body cycles through all of the stages of sleep four to six times each night, going through one about once every ***90 to 120 minutes***. The patterns in how you progress through these sleep cycles are affected by a variety of factors, including age, sex, and recent sleep habits.

https://sleepdoctor.com/pages/health/what-is-sleep

---

**What is a nap?**

A nap is a short period of sleep, typically taken during the day. Naps can be classified in several ways, such as by how long they last and what function they serve.

***Short naps that typically last about 15 to 30 minutes and longer naps of about 90 minutes*** can both be effective at promoting wakefulness, though experts most often recommend shorter naps. Research has found that a short nap consisting of light sleep can immediately reduce drowsiness after waking.

***Naps longer*** than 30 minutes may cause grogginess or disorientation after waking, known as sleep inertia. This may be because the longer a person sleeps, the deeper the sleep becomes, and the more difficult it can be to wake up. But longer naps may be helpful in more specific situations, such as for people who work long hours.

https://sleepdoctor.com/pages/health/types-of-naps

---

**Does Napping Count as Sleep?**

While napping can contribute to your overall rest, it does not provide the same benefits as a complete sleep cycle. Naps are beneficial for immediate relief from sleepiness and can improve alertness and performance. However, they are not a substitute for the comprehensive benefits of nighttime sleep, which is crucial for deeper physical and mental recovery. So, it’s not a great idea to take naps instead of sleeping and to turn napping into a habit to replace regular sleep.

https://sleepdoctor.com/pages/health/napping

---

**Segmented Sleep Patterns**

Segmented sleep is a pattern in which nightly sleep is broken down into two or more segments, with times of wakefulness in between. It’s also known as biphasic or polyphasic sleep. 

Segmented sleep patterns are often more practical in cultures where work, social activities, and religious schedules are cyclical or change according to the seasons.

***Although most people in the United States are monophasic sleepers, some people choose to adopt a biphasic sleep pattern.***

***Biphasic sleep vs. monophasic sleep:*** Many people today maintain a monophasic sleep schedule and get all of their rest in one long block of nighttime sleep. In a biphasic sleep pattern, the individual divides their total daily sleep time into two segments. They may sleep for a shorter period at night and take a long daytime nap, spend most of the night sleeping and take a brief nap during the day, or split nighttime sleep into two separate periods.
***Biphasic sleep vs. polyphasic sleep:*** While biphasic patterns divide sleep into two parts, polyphasic sleep involves numerous short blocks of sleep across a 24-hour period. A polyphasic pattern reduces nighttime sleep and involves multiple daytime naps. Some polyphasic sleep plans seek to reduce the total number of hours an individual sleeps each day, while others develop as a result of work or religious obligations.

https://sleepdoctor.com/pages/health/biphasic-sleep

---

**Is Biphasic Sleep Good For You?**

There is no definitive evidence that biphasic sleep is better or worse than monophasic sleep. Some research suggests that biphasic patterns are natural adaptations to environmental changes.
Many historical cultures are believed to have adopted biphasic sleep patterns in response to seasonal shifts in weather, daylight, and food availability. However, biphasic sleep practices are also common among people who live near the equator that do not experience many seasonal changes. While this may indicate that biphasic sleep comes more naturally than monophasic sleep in some situations, more research is needed to determine which sleep patterns, if any, are better than others.

***Whether sleep is monophasic or biphasic, it is important to get enough hours of total sleep each day. For most adults, experts recommend sleeping seven to nine hours per night in order to promote physical and mental health***.

https://sleepdoctor.com/pages/health/biphasic-sleep

---

**Can a segmented sleep count into the total daily sleep?**

Based on this [study](https://www.nature.com/articles/s41598-021-84625-8?utm_source=chatgpt.com), 112 adolescents who underwent two simulated school weeks containing 8 or 6.5 h sleep opportunities each day. Sleep episodes were nocturnal or split between nocturnal sleep and a 90-min afternoon nap, creating four experimental groups: 8 h-continuous, 8 h-split, 6.5 h-continuous and 6.5 h-split. Declarative memory was assessed with picture encoding and an educationally realistic factual knowledge task. Splitting sleep significantly enhanced afternoon picture encoding and factual knowledge under both 6.5 h and 8 h durations. Splitting sleep also significantly reduced slow-wave energy during nocturnal sleep, suggesting lower homeostatic sleep pressure during the day. There was no negative impact of the split sleep schedule on morning performance, despite a reduction in nocturnal sleep. 

***These findings suggest that naps could be incorporated into a daily sleep schedule that provides sufficient sleep and benefits learning***.

However, ***Sleep Health*** reports that there are significant concerns with segmented sleep, especially that it reduces the total number of sleep hours. Specifically, after reviewing 22 studies, researchers found that those following the segmented sleep schedule reported lower sleep quality, took longer to fall asleep, woke up more often, spent more time in lighter stages of sleep, and had less REM sleep. This may prevent them from getting the benefits of sleep.

---

***Based on the researching, napping can contribute to your overall rest, altohugh it does not provide the same benefits as a complete sleep cycle. Naps are beneficial for immediate relief from sleepiness and can improve alertness and performance. Meanwhile, whether sleep is monophasic or biphasic, it is important to get enough hours of total sleep each day***

---

***Can a segmented sleep and naps count into the total daily sleep?***

Yes, both segmented sleep (multiple sleep periods in a 24-hour period) and naps can be counted towards your total daily sleep. However, the quality and impact of segmented sleep can vary, and it's generally recommended to aim for a consolidated block of sleep for optimal health benefits. 


## Average Total Daily Sleep Time (including naps and segmented sleep).


Query.

	SELECT 
	  Id,
	  ROUND(AVG(total_minutes), 1) AS average_daily_minutes,
	  ROUND(AVG(total_minutes)/60, 1) AS average_daily_hours,
	
	FROM (
	  SELECT  
	  Id,
	  EXTRACT(DATE FROM activityMinute) AS day,
	  COUNT(DISTINCT logId) AS total_Sleep_Records,
	  COUNT(*) AS total_minutes,
	
	  FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	  GROUP BY Id, day
	  ORDER BY Id, day
	)
	
	GROUP BY Id
	ORDER BY average_daily_hours DESC


---

Experts agree that, throughout adulthood, most people should sleep for at least seven hours per day. The amount of sleep needed varies from person to person and changes over a lifetime. 

Most adults need at least 7 hours of sleep per night. The many benefits of sleep should encourage anyone to make sleep a priority, even if it means adjusting your sleep schedule. Sufficient sleep during adulthood promotes the abilities to learn, remember, and can help stave off cognitive decline that sometimes causes trouble as people age.

During the adult years, people often have multiple academic, occupational, family-related, and other demands on their time. This can make it hard for them to carve out enough room in their schedule for adequate sleep. In the United States, almost 30% of adults report getting six hours or less of sleep each night.

Sleep patterns change as a person ages. Older adults commonly have trouble getting enough sleep as their sleep-wake cycle becomes weaker. Both daytime sleepiness and daytime naps become more common in later adulthood.

https://sleepdoctor.com/pages/health/how-much-sleep-do-you-need

---

![image](https://github.com/user-attachments/assets/765b1ecd-726e-4401-9ea5-a973953d5a29)
 

Observations.

- ***We can observe two outliers. Two users getting 1.2 and 1.9 hours of daily average daily sleep***.

---

**Addressing Outliers**


Query.

	SELECT  
	  Id, 
	  EXTRACT(DATE FROM activityMinute) AS day,
	  MIN(activityMinute) AS time_sleepRecord_started,
	  logId,
	  COUNT(*) AS total_minutes,
	  ROUND(COUNT(*)/60, 1) AS total_hours,
	  COUNTIF(value = 1) AS total_minutesAsleep,
	  COUNTIF(value = 2) AS total_minutesRestless,
	  COUNTIF(value = 3) AS total_minutesAwake
	
	FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	WHERE Id = 4558609924 OR Id = 7007744171
	
	GROUP BY Id, day, logId
	ORDER BY Id, day, logId



![image](https://github.com/user-attachments/assets/3c1b0f4c-8167-47b8-b063-f178a8f77456)


---

Observations.

- ***We can notice both users having inconsistency tracking their sleep througout the two monts, they missed several days:***
  ***User 4558609924 only tracked 12 days***.
  ***User 7007744171 only tracked 10 days***.
- ***User 4558609924 tracked an average daily sleep time of 1.88 hours***.
- ***User 7007744171 tracked an average daily sleep time of 1.18 hours***.

It's most likely these users were using their devices to only tracked their naps but only in some certain days of the whole two months. Therefore, we will exclude them from the analysis.

---

**Average Total Daily Sleep Time (including naps and segmented sleep) and without outliers**.

![image](https://github.com/user-attachments/assets/39342d0a-68c9-48a0-a7a4-e51f24db6cfb)


---

Observations.

- ***The average total daily sleep time across the participants in this case study is 7 hours. Which means, the average participants are achieving the daily goal of 7 hours of sleep  for maintaining optimal mental health, physical health, and overall well-being. However, we are including naps and sleep segmented in this result. This doesn't tell us the real average  daily sleep time that users get during the night and then offset with naps***.

---

## Average Total Daily Sleep Time (full cycles of sleep).

While napping can contribute to your overall rest, it does not provide the same benefits as a complete sleep cycle.  Naps are beneficial for immediate relief from sleepiness and can improve alertness and performance. However, they are not a substitute for the comprehensive benefits of nighttime sleep, which is crucial for deeper physical and mental recovery.

During a night of sleep, your body cycles through four stages of sleep. The first three stages are called non-rapid eye movement (NREM) sleep and the final stage is called rapid eye movement (REM) sleep. Each stage is associated with a different depth of sleep as well as specific patterns in brain waves and muscle activity in the body.

Your body cycles through all of the stages of sleep four to six times each night, going through one about once every 90 to 120 minutes.

***A single sleep cycle, which includes both REM and non-REM (NREM) stages, typically lasts about 90 to 120 minutes***.

---

Therefore, we will estimate the average total daily sleep without counting the naps (<120 minutes) during daytime and including full cycles of sleep (>120 minutes).

Daytime tipically is described as the period between the time when the sun rises and the time it goes down. It is the time when people usually go to work, school, or play outside. 
However, we also know that people may *sleep in* especially during the days off, which is the action when people remain asleep or in bed later than usual in the morning. This means that users can remain asleep after 8:00 am or even 10:00 am. To cover this common situation, we will redefine the daytime period to capture effectively the naps that users used to have. We will filter out naps between 12:00 pm to 8:59 pm.

This means that will take into account the the sleep records that happend to be from 9:00 pm to 11:59 am (next day). However, to filter by a TIME range that crosses midnight, we need to redefine our time range:

- sleep that starts after 20:59:00 (8:59 PM) until 23:59:59 (11:59 PM)

- and sleep that starts after 00:00:00 (midnight) until 11:59:00 AM
  

---

To calculate the total daily sleep (in a 24-hour period), we are only takning into account full cycles of sleep (>120 minutes). However, there is a dilema because participants could have started tracking their sleep record (logId) at 11:20 pm and finished at 2:00 am (next day) right? This makes the sleep record (logId) split in to two parts; 40 minutes of this sleep record goes to one day and the rest goes to the next day. It will lead to removing this 40 minutes from the day without knowing that they were part of longer sleep record that crosses the midnight. To avoid removing minutes that were part of a longer sleep record, we will allow all sleep records that started between 10:29 pm and 11:59 pm appear in the results, meaning it doesn't matter these records lasted less than 120 minutes, since it's most likely that they were part of longer sleep record.



Query.

	SELECT
	  Id,
	  ROUND(AVG(daily_total_minutes), 1) AS average_daily_minutes,
	  ROUND(AVG(daily_total_minutes)/60, 1) AS average_daily_hours
	  
	FROM (
	  SELECT
	    Id,
	    day,
	    SUM(total_minutes) daily_total_minutes
	
	  FROM (
	    SELECT  
	      Id,
	      EXTRACT(DATE FROM activityMinute) AS day,
	      EXTRACT(TIME FROM MIN(activityMinute)) AS start_sleepRecord,
	      logId,
	      COUNT(*) AS total_minutes
	
	    FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	    GROUP BY Id, day, logId
	
	    HAVING
	    (start_sleepRecord BETWEEN '22:29:00' AND '23:59:00')
	    OR
	    (total_minutes > 90
	    AND ( start_sleepRecord > TIME '19:59:00'
	    OR start_sleepRecord <= TIME '11:59:00' ) #TIME range that crosses midnight
	    )
	    ORDER BY Id, day
	  )
	
	  GROUP BY
	  Id,
	  day 
	  
	  ORDER BY 
	  Id,
	  day)
	
	GROUP BY
	Id
	
	ORDER BY
	average_daily_hours DESC




![image](https://github.com/user-attachments/assets/1d3fc4ee-4292-475b-a3ca-3ed5b7f744d4)


---

Observations.

- ***The average total daily sleep across all users have interestingly increased from 7.085 to 7.214 hours. This is weird because we expected a result lower due to we are removing the naps from the calculation and we only took into account full cycles of slee (>120 minutes)***. 

---

Diving deep into this anomaly, we figured out if there were days when the users only tracked their naps or unusual sleep records (<120 minutes) in the calculation of the daily average that includes naps and sleep segmeneted.


Query.

	SELECT  
	  Id,
	  EXTRACT(DATE FROM activityMinute) AS day,
	  COUNT(DISTINCT logId) AS total_Sleep_Records,
	  COUNT(*) AS total_minutes,
	
	FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	GROUP BY Id, day
	
	HAVING total_minutes < 120
	
	ORDER BY Id, day


![image](https://github.com/user-attachments/assets/73b79a76-1b11-42d7-a753-aebcea171510)


Observations.

- ***We can observe that the vast majority of users tracked several days when they got less than 120 minutes of sleep per day. These days with low minutes of sleep direclty decrease the average total daily sleep time when we consider all sleep records happen to be in a day (including naps and segmented sleep)***.
- Fitbit devices automatically detect sleep when a user wear their device to bed. When user's body is completely at rest and they haven’t moved for about an hour, the device records that the user is asleep. Moreover, Fitbit device detects and records naps that are at least an hour long and users can edit or delete a sleep log in the Fitbit app. ***This means that users' sleep records that were greater than 60 minutes but less than 120 minutes are most likely due to nap records. However, the days when the users got less than 60 minutes of total sleep a day are due to certain anomalies with the Fitbit device. It's likely users didn't wear their device for tracking their sleep at all in certain days but the device still tracked a sleep record due to either a glitch in the device or an error in the system***.

---

***Therefore, we can claim that calculating the average total daily sleep time using full cycles of sleep and without counting the daytime naps is a more accurate result than using all sleep records (outliers and naps)***.
***The average total daily sleep time of the total sample in this data is 7.215 hours. However, this means that there are users sleep less than the average and there are other users that sleep more***.

---


## Distribution of users by daily sleep quantity.

- Experts recommend adults get at least 7 hours of sleep per night for better health.
- Getting less than 7 hours of sleep can negatively affect your physical and mental health.


People’s sleep needs change as they age. Babies typically need 12 or more hours of sleep a day, including naps, for healthy development. As they grow, toddlers and children require fewer naps, but they still typically need 10 or more hours of sleep each day.


| Age Group | Age Range | Recommended Hours of Sleep |
| --- | --- | --- |
| Infant | 4-12 months old | 12-16 hours (including naps) |
| Toddler | 1-2 years old | 11-14 hours (including naps) |
| Preschool | 3-5 years old | 10-13 hours (including naps) |
| School-age | 6-12 years old | 9-12 hours |
| Teen | 13-18 years old | 8-10 hours |
| Adult | 18 years old and older | 7 or more hours |


While these recommendations outline how much sleep most people in each age group need, individuals’ sleep needs will vary. Seven hours may not be enough sleep for some adults to feel refreshed. In addition, people who are sleep deprived or who have fragmented sleep may need extra rest to make up for lost sleep.

On the other hand, some people are naturally short sleepers who feel alert and healthy with less than six hours of sleep per night. For short sleepers, seven hours may be excessive.


https://www.sleepfoundation.org/sleep-faqs/is-7-hours-of-sleep-enough

---


Query.

	WITH average_daily_sleep AS (
	  SELECT
	  Id,
	    ROUND(AVG(daily_total_minutes), 1) AS average_daily_minutes,
	    ROUND(AVG(daily_total_minutes)/60, 1) AS average_daily_hours
	    
	  FROM (
	    SELECT
	      Id,
	      day,
	      SUM(total_minutes) daily_total_minutes
	
	    FROM (
	      SELECT  
	        Id,
	        EXTRACT(DATE FROM activityMinute) AS day,
	        EXTRACT(TIME FROM MIN(activityMinute)) AS start_sleepRecord,
	        logId,
	        COUNT(*) AS total_minutes
	
	      FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	      GROUP BY Id, day, logId
	
	      HAVING
	      (start_sleepRecord BETWEEN '22:29:00' AND '23:59:00')
	      OR
	      (total_minutes > 90
	      AND ( start_sleepRecord > TIME '19:59:00'
	      OR start_sleepRecord <= TIME '11:59:00' ) #TIME range that crosses midnight
	      )
	      ORDER BY Id, day
	    )
	
	    GROUP BY
	    Id,
	    day 
	    
	    ORDER BY 
	    Id,
	    day)
	
	  GROUP BY
	  Id
	
	  ORDER BY
	  average_daily_hours DESC
	)
	
	SELECT 
	  daily_amount_sleep,
	  COUNT(*) AS number_of_users
	
	FROM(
	  SELECT 
	  Id,
	  average_daily_hours,
	  IF(average_daily_hours > 7, 'Enough Sleep', 'Poor Sleep') AS daily_amount_sleep
	
	  FROM average_daily_sleep
	
	  WHERE Id != 4558609924 #Filter out the outliers 
	)
	
	GROUP BY daily_amount_sleep




![image](https://github.com/user-attachments/assets/e48e82af-5e92-41df-a01a-4653c729eefb)


---

Observations.

- For this calculation. we filtered out the outliers (the two users who tracked less than two hours in average daily sleep time). Sampling was reduced from 22 to 20 users.
- ***65% of the sample (13 users) are getting more than 7 hours a day in average. More than half users are sleeping more than 7 hours which is generally considered beneficial for health***.
- ***35% of the sample (7 users) are not getting enough sleep time in average. While some individuals may function well with less sleep, regularly sleeping less than 7 hours can be associated with adverse health outcomes***.

---

## Sleep Efficiency

LogId is the unique log id in Fitbit’s system for a sleep record. This sleep record tracks sleep pattern which includes user's time spent awake, restless, and asleep. Restless sleep indicates that the user move in their sleep, like if they toss and turn. If user's device detects excessive movement, enough that restful sleep won't be possible, the device records time spent awake.


The definition of sleep efficiency is the percentage of time we spend asleep while in bed. Time spent in bed not trying to sleep—while reading, for example, doesn’t count. You can calculate your sleep efficiency by dividing the time you’re asleep by the total time in bed. So, if you sleep for six out of eight hours in bed, your sleep efficiency is 75%. What’s a good score? Anything 85% or higher is considered “normal.”

It is calculated by dividing the amount of time spent asleep (in minutes) by the total amount of time in bed (in minutes).

Sleep Efficiency = (Total Sleep Time / Time in Bed) * 100 

But, when it comes to putting a quantifiable number on slumber, it’s complicated. A high score doesn’t necessarily indicate a good night’s sleep and vice versa. You might have a high sleep efficiency calculation because you only slept for three hours. Or you could wake up feeling well rested after 10 hours in bed and still have a low efficiency score.


https://sleepcycle.com/sleep-talk/what-determines-sleep-efficiency

---

**Different Sleep Efficiency Rates**

Sleep efficiency rates have a tendency to vary from person to person. As a result, sleep efficiency rates are categorized to determine what a healthy rate is and what can be improved upon.

- 90% or higher = very good sleep efficiency.
- 85%-90% = normal sleep efficiency.
-  < 85% = poor sleep efficiency.
- < 75% = sleeping disorders may arise.


https://biostrap.com/academy/sleep-efficiency/

---

To accurately calculate the sleep efficiency value for each user in the sample, we will follow the same frame of full cycles of sleep as before as well as omiting some outliers to prevent any skewed result.

Value indicating the sleep state.

1 = asleep, 2 = restless, 3 = awake


Query.

	WITH daily_hours AS (
	  SELECT
	  Id,
	  ROUND(AVG(daily_total_minutes)/60, 1) AS average_daily_hours,
	  ROUND(AVG(daily_total_minutes_asleep)/60, 1) AS average_daily_hours_asleep
	    
	  FROM (
	    SELECT
	      Id,
	      day,
	      SUM(total_minutes) AS daily_total_minutes,
	      SUM(total_minutes_asleep) AS daily_total_minutes_asleep 
	
	    FROM(
	      SELECT  
	        Id,
	        EXTRACT(DATE FROM activityMinute) AS day,
	        EXTRACT(TIME FROM MIN(activityMinute)) AS start_sleepRecord,
	        logId,
	        COUNT(*) AS total_minutes,
	        COUNTIF(value = 1) AS total_minutes_asleep,
	        COUNTIF(value = 2) AS total_minutes_restless,
	        COUNTIF(value = 3) AS total_minutes_awake
	
	      FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	      WHERE Id NOT IN (4558609924, 7007744171) #Filter out the outliers 
	
	      GROUP BY Id, day, logId
	
	      HAVING (start_sleepRecord BETWEEN '22:29:00' AND '23:59:00')
	        OR
	        (total_minutes > 90
	        AND ( start_sleepRecord > TIME '19:59:00'
	        OR start_sleepRecord <= TIME '11:59:00' ) #TIME range that crosses midnight
	        )
	      ORDER BY Id, day
	    )
	
	    GROUP BY Id, day 
	      
	    ORDER BY Id, day
	  )
	
	  GROUP BY  Id
	)
	
	SELECT
	  Id,
	  sleep_efficiency,
	  CASE
	  WHEN sleep_efficiency < 0.75 THEN 'Sleeping Disorders'
	  WHEN sleep_efficiency BETWEEN 0.75 AND 0.84  THEN 'Poor Sleep'
	  WHEN sleep_efficiency BETWEEN 0.85 AND 0.90 THEN 'Normal Sleep'
	  ELSE 'Very Good Sleep'
	  END AS sleep_efficiency_rate
	
	FROM(
	
	  SELECT
	    Id,
	    ROUND((average_daily_hours_asleep/average_daily_hours), 4) AS sleep_efficiency,
	
	  FROM daily_hours
	)
	
	ORDER BY sleep_efficiency


---

![image](https://github.com/user-attachments/assets/abae1405-397e-4536-9096-7926f695e05c)

![image](https://github.com/user-attachments/assets/409783b1-02f4-4906-a1dc-2ce3b039b76f)



Observations.

- ***We can observe that the vast majority (85%) of users are having a very good sleep efficiency, meaning they are actually spending most of the time asleep when they go to bed***.
- ***One user got 64.38% of sleep efficiency. This perecentage is under 75% metric which might indicate possible sleeping disorders***.
- ***Two users got poor sleep. They represent the 10% of the total sample***.
- ***We can notice that there weren't users with a normal sleep efficiency, which it's interesting because we expected the vast majority of users would be between 'normal sleep efficiency' and 'poor sleep efficiency'***.
- ***However, a high score doesn’t necessarily indicate a good night’s sleep and vice versa. Users might have a high sleep efficiency calculation but a poor sleep quantity (time sleeping)***.



## Sleep Quantity vs Sleep Efficiency (Quality).

The amount of time you sleep as well as the quality of your sleep are both important. Both sleep quantity and sleep quality are fundamental components of sleep. Therefore, we will compare the these metrics to accurately assess the sleep performance of users in this study.

We saved the results of both previous queries in BigQuery, one that returns the results of daily average sleep time and the other that returns the daily average sleep efficiency. We saved these results as BigQuery tables in our `analysis` dataset.

- daily average sleep time -> `average_sleep_quantity`
- daily average sleep efficiency -> `average_sleep_efficiency`
  

Now, we performed a new query to join the rows of both tables.


Query.

	SELECT 
	  quantity.Id,
	  average_daily_hours,
	  daily_amount_sleep,
	  quality.sleep_efficiency,
	  quality.sleep_efficiency_rate
	
	FROM `analysisbellabeat246.analysis.average_sleep_quantity` AS quantity
	
	INNER JOIN `analysisbellabeat246.analysis.average_sleep_efficiency` AS quality
	ON quantity.Id = quality.Id




---

![image](https://github.com/user-attachments/assets/79e2e4dc-99b2-4978-9fbf-d4daddae9558)

![image](https://github.com/user-attachments/assets/96482632-e1d3-454c-aeda-303166a5c37f)


Observations.

We classified the users in different groups based on their daily average sleep time and their daily average sleep efficiency.

- ***Even though the vast majority of the sample (17 users) are getting a very good sleep efficiency, 7 of them are sleeping less than 7 hours a day, representing an insufficient sleep time (less than 7 hours). This represents a short but efficient sleep***.
- ***10 users not only achieved enough sleep (more than 7 hours), but they also are got a very good sleep efficiency rate (more than 90%)***.
- ***The two users who sleep the most (8.7 and 8.5 hours) are actually having poor sleep efficiency, meaning even though they sleep for more hours per day, they struggle with resltless sleep or wake up troughout the night***.
- ***The person with sleep disorders (sleep efficiency < 75%) is actually sleeping more than 7 hours per day. This represents a long sleep but inefficient.***.




## Classification sleep performance (quantity vs quality)


We classified our users based on their average sleep time and the efficency of this. The categories are:

- *high-performance sleep*: average daily hours > 7 and sleep efficiency > 0.90 
- *short but highly efficient sleep*: average daily hours < 7 and sleep efficiency > 0.90 
- *normal-efficient sleep*: average daily hours > 7 and 0.85 ≤ sleep efficiency ≤ 0.90
- *short but efficient sleep*: average daily hours < 7 and 0.85 ≤ sleep efficiency ≤ 0.90
- *long but inefficient sleep*: average daily hours > 7 and 0.75 ≤ sleep efficiency ≤ 0.84
- *poor-inefficient sleep*: average daily hours < 7 and 0.75 ≤ sleep efficiency ≤ 0.84
- *restless sleep*: average daily hours > 7 and sleep efficiency < 0.75
- *sleep deprivation*: average daily hours < 7 and sleep efficiency < 0.75


Query.

	WITH sleep_quality_quantity AS(
	  SELECT 
	    quantity.Id,
	    quantity.average_daily_hours,
	    quantity.daily_amount_sleep,
	    quality.sleep_efficiency,
	    quality.sleep_efficiency_rate
	  
	
	  FROM `analysisbellabeat246.analysis.average_sleep_quantity` AS quantity
	
	  INNER JOIN `analysisbellabeat246.analysis.average_sleep_efficiency` AS quality
	  ON quantity.Id = quality.Id
	)
	
	SELECT 
	  Id,
	  average_daily_hours,
	  sleep_efficiency,
	  CASE
	  WHEN average_daily_hours > 7 AND sleep_efficiency > 0.90 THEN 'high-performance sleep'
	  WHEN average_daily_hours < 7 AND sleep_efficiency > 0.90 THEN 'short but highly efficient sleep'
	  WHEN average_daily_hours > 7 AND sleep_efficiency BETWEEN 0.85 AND 0.90 THEN 'normal-efficient sleep'
	  WHEN average_daily_hours < 7 AND sleep_efficiency BETWEEN 0.85 AND 0.90 THEN 'short but efficient sleep'
	  WHEN average_daily_hours > 7 AND sleep_efficiency BETWEEN 0.75 AND 0.84 THEN 'long but inefficient sleep'
	  WHEN average_daily_hours < 7 AND sleep_efficiency BETWEEN 0.75 AND 0.84 THEN 'poor-inefficient sleep'
	  WHEN average_daily_hours > 7 AND sleep_efficiency < 0.75 THEN 'restless sleep'
	  WHEN average_daily_hours < 7 AND sleep_efficiency < 0.75 THEN 'sleep deprivation'
	  END AS sleep_performance
	
	FROM sleep_quality_quantity


Customize color palette:

- high-performance sleep: Green.
- short but efficient sleep: Yellow.
- long but inefficient sleep: Orange.
- restless sleep: Red.


![image](https://github.com/user-attachments/assets/850aa1a9-b434-4439-9fa3-bedbc1bee28d)


---

Observations.

- ***Half of the participants got a high-performance sleep, meaning they not only slept more than 7 hours (experts recommendation) but also they achieved great sleep efficiency (they spend of the time asleep and with minimum disruptions or restless periods). This promotes a deep sleep that will provide physical and energy restoration, memory consolidation, hormone regulation, and immune system boost***.
- ***35% of the sample got a short but efficient sleep. This means that even though these participants slept less than 7 hours in daily average, they got a high efficiecny in their sleep, meaning they spent the most of the time asleep with minimun disruptions or restless periods. Research has suggested that inherited genes might enable some people to sleep six hours or less per night without showing signs of sleep deprivation. Although rare, some people can get by on less than six hours of sleep without symptoms like fatigue or daytime sleepiness***.
- ***10% of participants got a long but inefficient sleep. In other words, these users are sleeping more than seven hours on average per day, but with many restless periods or disruptions when they were in bed, this provoke a poor sleep quality. It doesn't matter if they are in bed more than 7 hours per day, they are actually asleep less than 7 hours. The possible causes may be stress and anxiety, poor sleep environment, irregular sleep schedule, too much screen time, lack of physical cctivity, medical conditions or medications***.
- ***Only one person which represent the 5% of the sample got resteless sleep. Although this person was sleeping more than 7 hours per day, this person might have been suffering insomnia, which can lead to sleep deprivation. These effects are really detrimental to the overall health and performance of this person***.


---

## Average sleep by day of the week.

Query.

	SELECT
	
	  FORMAT_DATE('%A', day) AS day_of_the_week,
	  ROUND(AVG(daily_total_minutes)/60, 1) AS average_daily_hours
	    
	FROM (
	  SELECT
	    Id,
	    day,
	    SUM(total_minutes) AS daily_total_minutes, 
	
	  FROM(
	    SELECT  
	      Id,
	      EXTRACT(DATE FROM activityMinute) AS day,
	      EXTRACT(TIME FROM MIN(activityMinute)) AS start_sleepRecord,
	      logId,
	      COUNT(*) AS total_minutes,
	
	    FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	    WHERE Id NOT IN (4558609924, 7007744171) #Filter out the outliers 
	
	    GROUP BY Id, day, logId
	
	    HAVING (start_sleepRecord BETWEEN '22:29:00' AND '23:59:00')
	        OR
	        (total_minutes > 90
	        AND ( start_sleepRecord > TIME '19:59:00'
	        OR start_sleepRecord <= TIME '11:59:00' ) #TIME range that crosses midnight
	        )
	      ORDER BY Id, day
	    )
	
	  GROUP BY Id, day 
	      
	  ORDER BY Id, day
	)
	
	GROUP BY day_of_the_week
	ORDER BY average_daily_hours




 ![image](https://github.com/user-attachments/assets/467f51a5-769e-4d33-ae69-d8f9c1ad9852)


 ---

 Observations.

 - ***The days when the users happen to sleep the most are during the weekend, Sunday and Saturday. They sleep on average between 7.7 to 8 hours. This pattern might be due to users trying to offset the inssuficient sleep that they accumulate during the weekdays in their days off. In the USA, the weekend is generally observed as days off from work. However many professions, such as those in retail, restaurants, healthcare, transportation, and emergency services, require weekend work due to the nature of their services***.
- ***Friday is the day when participants slept the less, achieving 6.6 hours on average. Remember that we are talking about the night time between Thursday to Friday and the hours of sleep before midnight during Friday. This value can be due to people have to work on Friday, meaning they have to wake up early. Also, Friday is considered the beginning of the weekend, so many people use this day for social interactions or late-night activities after work until midnight***.
- ***We can also observe a small rebound in sleep on Wednesday during the weekdays. This recovery might have been due to users trying to offset the stress and fatigue accumulated during the first weekdays. This day can be interpreted as the cope mechanism to the total workload of the week***.
- ***Actually we can observe how the daily average sleep time decreases as the weekdays go by, from Monday to Tuesday and from Wednesday to Friday. Wednesday acts as day to reset this steady decrement***.

---

## Correlation between the variables Sleep vs Steps / Sleep vs Intensity

In order to merge the data, first we need to aggregate and create the tables with the relevant information for this analysis.


**Sleep**.


Query.

	SELECT 
	  Id,
	  day,
	  daily_total_minutes AS daily_sleep_minutes,
	  ROUND(daily_total_minutes_asleep/daily_total_minutes, 4) AS daily_sleep_efficiency
	
	
	FROM(
	  SELECT
	    Id,
	    day,
	    SUM(total_minutes) AS daily_total_minutes,
	    SUM(total_minutes_asleep) AS daily_total_minutes_asleep 
	
	  FROM (
	    SELECT  
	      Id,
	      EXTRACT(DATE FROM activityMinute) AS day,
	      EXTRACT(TIME FROM MIN(activityMinute)) AS start_sleepRecord,
	      logId,
	      COUNT(*) AS total_minutes,
	      COUNTIF(value = 1) AS total_minutes_asleep,
	
	    FROM `analysisbellabeat246.clean_data.minuteSleep_cleaned` 
	
	    WHERE Id NOT IN (4558609924, 7007744171) #Filter out the outliers 
	
	    GROUP BY Id, day, logId
	
	    HAVING (start_sleepRecord BETWEEN '22:29:00' AND '23:59:00')
	      OR
	      (total_minutes > 90
	      AND ( start_sleepRecord > TIME '19:59:00'
	      OR start_sleepRecord <= TIME '11:59:00' ) #TIME range that crosses midnight
	      )
	
	    ORDER BY Id, day
	  )
	
	  GROUP BY Id, day
	)
	
	WHERE daily_total_minutes_asleep/daily_total_minutes != 0
	
	ORDER BY Id, day


---

We save the results as a BigQuery table called `sleep_to_merge` in our `analysis` dataset.


**Steps and Intensity**

Query.

	SELECT  
	  Id,
	  activityDate,
	  totalSteps,
	  totalIntensity
	
	FROM `analysisbellabeat246.analysis.dailyActivity` 
	
	WHERE totalSteps != 0 AND totalIntensity != 0 AND MET_minutes != 0
	
	ORDER BY Id, activityDate


---

We save the results as a BigQuery table called `steps_intensity_to_merge` in our `analysis` dataset.



**Merging both tables**


Query.

	SELECT
	  sleep.Id,
	  sleep.day,
	  sleep.daily_sleep_minutes,
	  sleep.daily_sleep_efficiency,
	  steps_intensity.totalIntensity,
	  steps_intensity.totalSteps
	
	FROM `analysisbellabeat246.analysis.sleep_to_merge` AS sleep
	INNER JOIN `analysisbellabeat246.analysis.steps_intensity_to_merge` AS steps_intensity
	  ON sleep.Id = steps_intensity.Id
	  AND sleep.day = steps_intensity.activityDate
 



![image](https://github.com/user-attachments/assets/628fd61d-16a5-4f3e-804d-1e1c444a9771)


---

Trend Line:

R-Squared: 0.0178235 -> 1.78%
p-value (significance):	0.574709

Observations.

- ***We can notice a pretty flat trend line and slightly going downwards. R-Squared value is pretty close to zero (0.017) indicating very weak or no correlation between average total steps and average daily sleep time, these variables do not have a relationship with each other. The trend line is not meaningful in a predictive or explanatory way***.
- ***The model explains very little of the variation in sleep based on steps***.

- ***p-value is equal to 0.57. This value is higher than the common threshold (p > 0.05), this means that the pattern is not statistically significant, so the relationship is likely due to chance**.

---

![image](https://github.com/user-attachments/assets/3cc6589a-bb73-4dcb-8093-e2cfd3d59df4)

---

Trend Line:

R-Squared: 0.0298655 -> 2.29%
p-value (significance):	0.466244

Observations.

- ***We can notice a pretty flat trend line that slightly goes down. R-Squared value is pretty close to zero (0.029) indicating very weak or no correlation between average total steps and average daily sleep time, these variables do not have a relationship with each other. The trend line is not meaningful in a predictive or explanatory way***.
- ***The model explains very little of the variation in sleep based on intensity***.
- ***p-value is equal to 0.46. This value is higher than the common threshold (p > 0.05), this means that the pattern is not statistically significant, so the relationship is likely due to chance**.

---

![image](https://github.com/user-attachments/assets/38b1f5a2-ddf3-472b-a66b-10e30b95d4e8)

---

Trend Line:

R-Squared: 0.0050913 -> 0.5%
p-value (significance):	0.764988

Observations.

- ***We can notice a pretty flat trend line slightly going upwards. R-Squared value is pretty close to zero (0.005) indicating very weak or no correlation between average total steps and average daily sleep time, these variables do not have a relationship with each other. The trend line is not meaningful in a predictive or explanatory way***.
- ***The model explains very little of the variation in sleep based on intensity***.
- ***p-value is equal to 0.76. This value is higher than the common threshold (p > 0.05), this means that the pattern is not statistically significant, so the relationship is likely due to chance**.

---

![image](https://github.com/user-attachments/assets/11996b3b-9c94-4218-b470-afbe8a058568)

---

Trend Line:

R-Squared: 0.0143453 -> 0.14%
p-value (significance):	0.61499


Observations.

- ***We can notice a pretty flat trend line that slightly goes up. R-Squared value is pretty close to zero (0.014) indicating very weak or no correlation between average total steps and average daily sleep time, these variables do not have a relationship with each other. The trend line is not meaningful in a predictive or explanatory way***.
- ***The model explains very little of the variation in sleep based on intensity***.
- ***p-value is equal to 0.61. This value is higher than the common threshold (p > 0.05), this means that the pattern is not statistically significant, so the relationship is likely due to chance**.

---



## Recommendations and insights.

Inactivity. 

- *18.75% inactive users for at at least one full week*.
- *12.75% inactive users for at least two full weeks*.
- *High levels of inactivity during the first three weeks, reaching the peak of inactive users during week 2 (zero steps, intensity, and METs)*
- *High Levels of Inactivity during the weekends*.


**Bellabeat should promote the usage of the wearable specially throughout the first week by sending notifications about the benefits of tracking health data**.

**Bellabeat should use friendly guided tutorials about how to use the wearable using spaced repetition through the App. For example, when the user is near to late hours (around 9 to 10 pm) the app automatically sends a reminder about tracking the sleep**.

**Provide a detailed explanation about the different metrics, their interpretation, benefits, and recommendations throughout the first week (one day explaining steps, another day explaining METs)**. 

**Send reminders through the app when the system doesn't receive data about user metrics during two consecutive days**.


---

Steps.

- *75% of people are under the daily goal of 10,000 steps*.
- *47% (almost the half) of users are sedentary and low active*.
- *28% of participants are somewhat active users*.
- *Saturday and Tuesday are the days when people give more steps*
- *Sunday and Friday were the days when the users gave less steps on average*.


**10,000 steps per day is an overall goal for maintaining a good health. However, steps counting by itself doesn't encompasses intensity levels for accurate determine the daily physical activity and calories burnt. An user might give less than 10,000 steps but with high levels of intensity, for example running for 20 minutes. Rather than using total steps as a goal, a holistic approach would be using MET/minutes or Intensity Levels calculated from the type of step taken (walking, jogging, running)**.


**Send notifications throughout the day about different ways how the user can accomplish their physical activty based on step-activities to achieve their fitness/health goals**.

For example:

- Leverage the most of the afternoon by running for 20 minutes or walk for 45 minutes in your favorite park to achieve your daily goal, you are almost done! 

**Send suggestions through the app on Sundays and (Saturdays at night) about how the user can engage in more quite step-activities during Sunday, for example going for a relaxing walk during the morning or visiting a new place along with family. Sundays are more commonly used for resting or hanging out with family and friends**.  

**Bellabeat should create an option that allow the user set out their physical activity that is mainly based on total steps taken. This will allow to not only better categorize physical activity based on steps, but also send customized suggestions about how users can achieve their daily steps taken**. 


---

METs.

- *The last week of the first month (week 4) was not only the week with more users reaching their goal of 600 MET-minutes per week, but also it was the week with more users wearing their devices more consistenly*.
- *There is a clear downward trend with the number of low-active users, suggesting a slight shift of users away from the low-active category over time. Possibly some users moved up to moderately active.*
- *There is a strong upward trend with the number of moderately-active users during weeks 1-7, reaching the peak of users moderately-active in week 7. This group is growing over time, especially during the first half. This indicates a positive trend where users are increasing their activity levels.*
- *There is a clear downward trend over the time of highly-active users. Highly active users reamin as the smallest group and there were even users that may have reduced their levels of activity over the time.*
- *More than half participants of the whole sample are low-active users, representing the 58%. Although, they were involved in low-active levels and achieving the minimum WHO recommendation, they are still gaining sustantial health benefits.*
- *More than a third part of the total users are moderately-active. This group are not only gaining sustantial health benefits, but research shows the largest gains in disease prevention*.
- *A very small percentage of users are highly-active, representing only 6% of the whole. However, research suggests that health gains above 8,000 MET-min/week are smaller.*.
- There a big difference of almost 2000 MET-minutes/week between the user with more MET-minutes/week in moderately-active group with the user with less MET-minutes/week in the highly-active group.


**Bellabeat should aim towards user's monthly health/fitness goals. Taking advantage of the inertia of more users using wearables more consistenly at the end of the first month, the company can provide a thorough summary about the metrics achieved in the end of each month to motivate users keep using their wearables with consistency.**

**Bellabeat should promote a customized plan that helps low-active users move up to more moderately physical activities through promoting how moderately physical activities can aid them gain sustantial health benefits, and how scientific reasearch has demonstrated that they can achieve the largest gains in disease prevention**.

**Bellabeat should more often send reminders to moderately-active and highly-active users about how well they are performing their physical activity levels. They should use friendly and encouraging messages that keep them accountable**.

**Investigate in depth what factors made highly-active users reduce their physical activity over the time, specially after the first month. Is it a seasonal factor? Is it a motivational fator? Is it an external event?**

**Bellabeat should target moderately-active users to help them streamline and optimize their routines, specially because data suggests how there is a strong upward trend of moderately-active users over the time. The company should promote coach and medical experts to these users, as well as promoting other products such as the "Spring" smart bottle water**.


---


Calories.

Calories vs Steps

*steps alone are not as strong predictor of calories burned compared to total intensity, likely because steps don’t capture activity intensity (for example, walking vs running) or because some participants were more involved in non-step activities like weight lifting or yoga that may not be well-represented by steps alone.*

Outliers:

*Some users burned fewer calories than expected for their step counts (below the trendline), perhaps walking at low intensity*.
*Others burned more calories than expected (above the trendline), possibly due to higher intensity activities or greater body mass*.

**Investigate and identify which factors are making users burnt more calories than expected based on steps counting. Also, figure out the correlation between users' body mass and their capacity to easily burnt calories**.

**Research more in depth if there is any correlation between diet/hydration and user's ease to burn calories with the same level of physical activity**.


Calories vs Intensity

*There is a slightly stronger relationship between calories with intensity than steps*.

*Some users burnt more calories than expected for their intensity (above the trendline). This can possibly be due to body composition, metabolism, age, diet, inefficient movement, etc*.
*Others burned fewer calories than expected (below the trendline). Perhaps due to body composition, metabolism, age, diet, more efficient movement, etc*.


**Bellabeat should promote more non-step activities and personalized routines with high levels of intensity to users who specially want to lose weight such as strenght workouts, weight lifting, swimming, etc. The data shows a stronger posivite correlation between calories burnt and levels of intensity than calories burnt and steps taken**. 

**Research more in depth if there is any correlation between user's demographic data such as age, body composition, metabolism, etc. and user's ease to burn calories with the same level of physical activity**.


---


Sleep.

- *The average total daily sleep time across the participants is 7.214 hours without including naps and sleep segmented in this result*.
- *The average total daily sleep time across users interestingly decreased from 7.214 to 7.085 hours when including naps during daytime, and sleep records that lasted less than 120 minutes. This is due to the vast majority of users had several days tracking sleep records that lasted less than 120 minutes per day. These days with low minutes of sleep direclty decrease the average total daily sleep time*.
- *Users' sleep records that were greater than 60 minutes but less than 120 minutes are most likely due to nap records. However, the days when the users got less than 60 minutes for a sleep record were due to certain anomalies with the Fitbit device. This is because Fitbit devices automatically detect sleep when a user wear their device to bed, and it detects and records naps that are at least an hour long. It's likely users didn't wear their device for automatically tracking their sleep at all in certain days but the device still tracked a sleep record due to either a glitch in the device or an error in the system or users only used their wearables to manually track their naps in certain days*.
- *Friday is the day when participants sleep the less, achieving 6.6 hours on average*.


Sleep Time.

- *65% of users are getting more than 7 hours a day in average. More than half users are sleeping more than 7 hours which is generally considered beneficial for health*.
- *35% of users are not getting enough sleep time in average. While some individuals may function well with less sleep, regularly sleeping less than 7 hours can be associated with adverse health outcomes*.

Sleep Efficiency.

- *We can observe that the vast majority (85%) of users are having a very good sleep efficiency, meaning they are actually spending most of the time asleep when they go to bed*.
- *One user got 64.38% of sleep efficiency. This perecentage is under 75% metric which might indicate possible sleeping disorders*.

Sleep Performance.

- *Half of the participants got a high-performance sleep, meaning they not only slept more than 7 hours (experts recommendation) but also they achieved great sleep efficiency (they spend of the time asleep and with minimum disruptions or restless periods). This promotes a deep sleep that will provide physical and energy restoration, memory consolidation, hormone regulation, and immune system boost*.
- *35% of the sample got a short but efficient sleep. This means that even though these participants slept less than 7 hours in daily average, they got a high efficiency in their sleep, meaning they spent the most of the time asleep with minimun disruptions or restless periods. Research has suggested that inherited genes might enable some people to sleep six hours or less per night without showing signs of sleep deprivation. Although rare, some people can get by on less than six hours of sleep without symptoms like fatigue or daytime sleepiness*.
- *10% of participants got a long but inefficient sleep. In other words, these users are sleeping more than seven hours on average per day, but with many restless periods or disruptions when they were in bed, this provoke a poor sleep quality. It doesn't matter if they are in bed more than 7 hours per day, they are actually asleep less than 7 hours. The possible causes may be stress and anxiety, poor sleep environment, irregular sleep schedule, too much screen time, lack of physical cctivity, medical conditions or medications*.
- *Only one person which represent the 5% of the sample got resteless sleep. Although this person was sleeping more than 7 hours per day, this person might have been suffering insomnia, which can lead to sleep deprivation. These effects are really detrimental to the overall health and performance of this person*.


**Bellabeat should promote a plan that provides information about user's sleep performance by comparing sleep efficiency and sleep time. This plan can also offers customized insisghts and tips about how users can improve their sleep quality**.

**Based on sleep quality and sleep duration of previous night, Bellabeat should send notifications to users about if it is necessary they need take a nap to offset the consequences of getting poor sleep. The company can promote how and when taking a nap based on sleep patterns**.

**Bellabeat should focus on users who are getting poor sleep to help them improve their sleep efficiency and sleep time, providing them a customized plan about how they can imporve their sleep environment, also suggesting meditation practices to manage stress and promoting naps to restore mental and physical vigor during the day**. 

**Bellabeat should send suggestions to users about when they should charge their devices to prevent users doing it when they go to sleep. Based on user's activity and sleep schedule, Bellabeat system can determie what is the best time to a user charge their devices without disrupting to track important data such as sleep**. 

**Analysis shows how a third part of population using wearables are getting short but efficient sleep. Bellabeat should promote personalized plans that can help user optimize and better manage their daily routine to allow them have more time to sleep**.

**Bellabeat should hire sleep experts or somnologists to include them in their plans to help users not only improve their sleep but also inform them about the importance sleep has in their physical and mental performance. Sleep doctors can potentially help users with sleep disorders and directly have a positive impact in their daily physical activity performance. This approach can lead to getting new customers who are interested on sleep**.

**Research in depth why users tend to sleep less on Friday. Bellabeat can address this issue by scheduling meditations and yoga practices on Thursday to release stress levels acumulated throughout the weekday. The company should also provide and schedule workout routines with high intensity levels to increase fatigue in users in order they go to sleep earlier and getting a deeper sleep**. 


## Next steps and further exploration.


- Focus on a sample entirely made up by women since Bellabeat products are oriented to this gender.
- Use a bigger sample size that can fairly represent the outreach market of wearables.
- Include demographic data such as age will allow to accurately categorize the groups in the data and better make sense of the trends.
- Include another factors such as diet, metabolism and body composition in the data to observe how they influence physical performance and calories burnt.
- Use a sample that covers a longer period time to identify holistic patterns in habits and lifestyle.

